/**********************************************************
* FT97B_X_functional.cc: definitions for FT97B_X_functional for KS-DFT
* Robert Parrish, robparrish@gmail.com
* Autogenerated by MATLAB Script on 06-Mar-2012
*
***********************************************************/
#include <libmints/mints.h>
#include <libfock/points.h>
#include "FT97B_X_functional.h"
#include <stdlib.h>
#include <cmath>
#include <string>
#include <string>
#include <vector>

using namespace psi;
using namespace boost;
using namespace std;

namespace psi { namespace functional {

FT97B_X_Functional::FT97B_X_Functional(int npoints, int deriv) : Functional(npoints, deriv)
{

    name_ = "FT97B_X";
    description_ = "Filitov and Theil 1997 Exchange";
    citation_ = "M. Filatov and W. Theil, Mol. Phys., 91(5), 847-859, 1997.";

    double c = -9.3052573634909974E-01;
    params_.push_back(make_pair("c",c));
    double d0 = 2.9136440000000000E-03;
    params_.push_back(make_pair("d0",d0));
    double d1 = 9.4741689999999995E-04;
    params_.push_back(make_pair("d1",d1));
    double d2 = 2.5011489999999999E+03;
    params_.push_back(make_pair("d2",d2));

    is_gga_ = true;
    is_meta_ = false;

    //Required allocateion
    allocate();
}
FT97B_X_Functional::~FT97B_X_Functional()
{
}
void FT97B_X_Functional::computeRKSFunctional(boost::shared_ptr<RKSFunctions> prop)
{
    int ntrue = prop->npoints();

    const double* restrict rho_a;
    const double* restrict gamma_aa;
    const double* restrict tau_a;

    rho_a = prop->property_value("RHO_A")->pointer();
    if (is_gga_) {
        gamma_aa = prop->property_value("GAMMA_AA")->pointer();
    }
    if (is_meta_) {
        tau_a = prop->property_value("TAU_A")->pointer();
    }

    double c = params_[0].second;
    double d0 = params_[1].second;
    double d1 = params_[2].second;
    double d2 = params_[3].second;

    //Functional
    for (int index = 0; index < ntrue; index++) {

        //Functional Value
        if (rho_a[index] > cutoff_) {
            double t3301 = 1.0/pow(rho_a[index],8.0/3.0);
            double t3302 = log(gamma_aa[index]*t3301+sqrt((gamma_aa[index]*gamma_aa[index])*(t3301*t3301)+1.0) \
               );
            double t3304 = d2*d2;
            double t3305 = gamma_aa[index]+t3304;
            double t3306 = 1.0/t3305;
            double t3307 = d1*gamma_aa[index]*t3306;
            double t3303 = d0+t3307;
            functional_[index] = c*pow(rho_a[index],4.0/3.0)*((gamma_aa[index]*t3301*t3303*1.0/sqrt(gamma_aa[index]* \
               t3301*(t3302*t3302)*(t3303*t3303)*9.0+1.0))/c-1.0)*-2.0;
        } else {
            functional_[index] = 0.0;
        } 

    }
    //First Partials
    for (int index = 0; index < ntrue && deriv_ >= 1; index++) {

        //V_rho_a
        if (rho_a[index] > cutoff_) {
            double t3309 = 1.0/pow(rho_a[index],8.0/3.0);
            double t3317 = gamma_aa[index]*t3309;
            double t3310 = log(t3317+sqrt(t3317*t3317+1.0));
            double t3312 = d2*d2;
            double t3313 = gamma_aa[index]+t3312;
            double t3314 = 1.0/t3313;
            double t3315 = d1*gamma_aa[index]*t3314;
            double t3311 = d0+t3315;
            double t3316 = 1.0/c;
            double t3318 = t3310*t3310;
            double t3319 = t3311*t3311;
            double t3320 = gamma_aa[index]*t3309*t3318*t3319*9.0;
            double t3321 = t3320+1.0;
            double t3322 = 1.0/sqrt(t3321);
            double t3323 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t3324 = gamma_aa[index]*gamma_aa[index];
            v_rho_a_[index] = c*pow(rho_a[index],1.0/3.0)*(gamma_aa[index]*t3311*t3322*t3316*t3309-1.0)*(-4.0/ \
               3.0)+c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t3311*t3322*t3323*t3316*(8.0/3.0)-gamma_aa[index]* \
               t3311*1.0/pow(t3321,3.0/2.0)*t3316*t3309*(gamma_aa[index]*t3323*t3318*t3319*2.4E1+1.0/pow(rho_a[index],1.9E1/ \
               3.0)*t3310*t3324*t3319*1.0/sqrt(1.0/pow(rho_a[index],1.6E1/3.0)*t3324+1.0)*4.8E1)*(1.0/2.0));
        } else {
            v_rho_a_[index] = 0.0;
        } 

        if (is_gga_) {

            if (rho_a[index] > cutoff_) {
                double t3326 = 1.0/pow(rho_a[index],8.0/3.0);
                double t3334 = gamma_aa[index]*t3326;
                double t3327 = log(t3334+sqrt(t3334*t3334+1.0));
                double t3329 = d2*d2;
                double t3330 = gamma_aa[index]+t3329;
                double t3331 = 1.0/t3330;
                double t3332 = d1*gamma_aa[index]*t3331;
                double t3328 = d0+t3332;
                double t3333 = 1.0/c;
                double t3335 = t3327*t3327;
                double t3336 = t3328*t3328;
                double t3337 = gamma_aa[index]*t3326*t3335*t3336*9.0;
                double t3338 = t3337+1.0;
                double t3339 = 1.0/sqrt(t3338);
                double t3340 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t3341 = d1*t3331;
                double t3342 = 1.0/(t3330*t3330);
                double t3343 = t3341-d1*gamma_aa[index]*t3342;
                v_gamma_aa_[index] = c*pow(rho_a[index],4.0/3.0)*(t3333*t3326*t3328*t3339+gamma_aa[index]*t3333*t3343* \
                   t3326*t3339-gamma_aa[index]*t3333*t3326*t3328*1.0/pow(t3338,3.0/2.0)*(t3326*t3335*t3336*9.0+gamma_aa[index]* \
                   t3340*t3327*t3336*1.0/sqrt((gamma_aa[index]*gamma_aa[index])*t3340+1.0)*1.8E1+gamma_aa[index]*t3343* \
                   t3326*t3335*t3328*1.8E1)*(1.0/2.0))*-2.0;
            } else {
                v_gamma_aa_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_tau_a
            if (rho_a[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else {
                v_tau_a_[index] = 0.0;
            } 

        }
    }
    //Second Partials
    for (int index = 0; index < ntrue && deriv_ >= 2; index++) {

        //V_rho_a_rho_a
        if (rho_a[index] > cutoff_) {
            double t3346 = 1.0/pow(rho_a[index],8.0/3.0);
            double t3354 = gamma_aa[index]*t3346;
            double t3347 = log(t3354+sqrt(t3354*t3354+1.0));
            double t3349 = d2*d2;
            double t3350 = gamma_aa[index]+t3349;
            double t3351 = 1.0/t3350;
            double t3352 = d1*gamma_aa[index]*t3351;
            double t3348 = d0+t3352;
            double t3353 = 1.0/c;
            double t3355 = t3347*t3347;
            double t3356 = t3348*t3348;
            double t3357 = gamma_aa[index]*t3346*t3355*t3356*9.0;
            double t3358 = t3357+1.0;
            double t3359 = 1.0/sqrt(t3358);
            double t3360 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t3361 = gamma_aa[index]*gamma_aa[index];
            double t3362 = 1.0/pow(t3358,3.0/2.0);
            double t3363 = 1.0/pow(rho_a[index],1.4E1/3.0);
            double t3364 = 1.0/pow(rho_a[index],1.6E1/3.0);
            double t3365 = t3361*t3364;
            double t3366 = t3365+1.0;
            double t3367 = 1.0/sqrt(t3366);
            double t3368 = gamma_aa[index]*t3360*t3355*t3356*2.4E1;
            double t3369 = 1.0/pow(rho_a[index],1.9E1/3.0);
            double t3370 = t3361*t3347*t3356*t3367*t3369*4.8E1;
            double t3371 = t3370+t3368;
            v_rho_a_rho_a_[index] = c*1.0/pow(rho_a[index],2.0/3.0)*(gamma_aa[index]*t3353*t3346*t3348*t3359- \
               1.0)*(-4.0/9.0)-c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t3353*t3363*t3348*t3359*(8.8E1/9.0)-gamma_aa[index]* \
               t3360*t3353*t3362*t3371*t3348*(8.0/3.0)-gamma_aa[index]*t3353*t3362*t3346*t3348*(gamma_aa[index]*t3363* \
               t3355*t3356*8.8E1+1.0/pow(rho_a[index],2.2E1/3.0)*t3361*t3347*t3356*t3367*4.32E2+(gamma_aa[index]* \
               1.0/pow(rho_a[index],1.0E1)*t3361*t3356*1.28E2)/t3366-1.0/pow(rho_a[index],3.8E1/3.0)*(t3361*t3361) \
               *t3347*t3356*1.0/pow(t3366,3.0/2.0)*1.28E2)*(1.0/2.0)+gamma_aa[index]*t3353*(t3371*t3371)*t3346*t3348* \
               1.0/pow(t3358,5.0/2.0)*(3.0/4.0))+c*pow(rho_a[index],1.0/3.0)*(gamma_aa[index]*t3360*t3353*t3348*t3359* \
               (8.0/3.0)-gamma_aa[index]*t3353*t3362*t3371*t3346*t3348*(1.0/2.0))*(8.0/3.0);
        } else {
            v_rho_a_rho_a_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_rho_a_gamma_aa
            if (rho_a[index] > cutoff_) {
                double t3373 = 1.0/pow(rho_a[index],8.0/3.0);
                double t3381 = gamma_aa[index]*t3373;
                double t3374 = log(t3381+sqrt(t3381*t3381+1.0));
                double t3376 = d2*d2;
                double t3377 = gamma_aa[index]+t3376;
                double t3378 = 1.0/t3377;
                double t3379 = d1*gamma_aa[index]*t3378;
                double t3375 = d0+t3379;
                double t3380 = 1.0/c;
                double t3382 = t3374*t3374;
                double t3383 = t3375*t3375;
                double t3384 = gamma_aa[index]*t3373*t3382*t3383*9.0;
                double t3385 = t3384+1.0;
                double t3386 = 1.0/sqrt(t3385);
                double t3387 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t3388 = d1*t3378;
                double t3389 = 1.0/(t3377*t3377);
                double t3397 = d1*gamma_aa[index]*t3389;
                double t3390 = t3388-t3397;
                double t3391 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t3392 = gamma_aa[index]*gamma_aa[index];
                double t3393 = t3392*t3387;
                double t3394 = t3393+1.0;
                double t3395 = 1.0/sqrt(t3394);
                double t3396 = 1.0/pow(t3385,3.0/2.0);
                double t3398 = 1.0/pow(rho_a[index],1.9E1/3.0);
                double t3399 = t3373*t3382*t3383*9.0;
                double t3400 = gamma_aa[index]*t3374*t3383*t3395*t3387*1.8E1;
                double t3401 = gamma_aa[index]*t3390*t3373*t3382*t3375*1.8E1;
                double t3402 = t3399+t3400+t3401;
                double t3403 = gamma_aa[index]*t3382*t3391*t3383*2.4E1;
                double t3404 = t3374*t3383*t3392*t3395*t3398*4.8E1;
                double t3405 = t3403+t3404;
                v_rho_a_gamma_aa_[index] = -c*pow(rho_a[index],4.0/3.0)*(t3380*t3391*t3375*t3386*(-8.0/3.0)-gamma_aa[index]* \
                   t3380*t3390*t3391*t3386*(8.0/3.0)+t3380*t3373*t3375*t3396*t3405*(1.0/2.0)+gamma_aa[index]*t3380*t3390* \
                   t3373*t3396*t3405*(1.0/2.0)+gamma_aa[index]*t3380*t3391*t3375*t3396*t3402*(4.0/3.0)+gamma_aa[index]* \
                   t3380*t3373*t3375*t3396*(t3382*t3391*t3383*2.4E1+(1.0/(rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]* \
                   rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index])*t3383*t3392*4.8E1)/t3394+gamma_aa[index]* \
                   t3390*t3382*t3391*t3375*4.8E1+gamma_aa[index]*t3374*t3383*t3395*t3398*1.44E2+t3390*t3374*t3392*t3375* \
                   t3395*t3398*9.6E1-gamma_aa[index]*1.0/pow(rho_a[index],3.5E1/3.0)*t3374*t3383*t3392*1.0/pow(t3394,3.0/ \
                   2.0)*4.8E1)*(1.0/2.0)-gamma_aa[index]*t3380*t3373*t3375*1.0/pow(t3385,5.0/2.0)*t3402*t3405*(3.0/4.0) \
                   )-c*pow(rho_a[index],1.0/3.0)*(t3380*t3373*t3375*t3386+gamma_aa[index]*t3380*t3390*t3373*t3386-gamma_aa[index]* \
                   t3380*t3373*t3375*t3396*t3402*(1.0/2.0))*(4.0/3.0);
            } else {
                v_rho_a_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_aa
            if (rho_a[index] > cutoff_) {
                double t3407 = d2*d2;
                double t3408 = gamma_aa[index]+t3407;
                double t3409 = 1.0/pow(rho_a[index],8.0/3.0);
                double t3414 = gamma_aa[index]*t3409;
                double t3410 = log(t3414+sqrt(t3414*t3414+1.0));
                double t3411 = 1.0/t3408;
                double t3416 = d1*gamma_aa[index]*t3411;
                double t3412 = d0+t3416;
                double t3413 = 1.0/c;
                double t3415 = t3410*t3410;
                double t3417 = t3412*t3412;
                double t3418 = gamma_aa[index]*t3415*t3417*t3409*9.0;
                double t3419 = t3418+1.0;
                double t3420 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t3421 = d1*t3411;
                double t3422 = 1.0/(t3408*t3408);
                double t3431 = d1*gamma_aa[index]*t3422;
                double t3423 = t3421-t3431;
                double t3424 = 1.0/sqrt(t3419);
                double t3425 = t3415*t3417*t3409*9.0;
                double t3426 = gamma_aa[index]*gamma_aa[index];
                double t3427 = t3420*t3426;
                double t3428 = t3427+1.0;
                double t3429 = 1.0/sqrt(t3428);
                double t3430 = gamma_aa[index]*t3410*t3420*t3417*t3429*1.8E1;
                double t3432 = gamma_aa[index]*t3412*t3423*t3415*t3409*1.8E1;
                double t3433 = t3430+t3432+t3425;
                double t3434 = 1.0/pow(t3419,3.0/2.0);
                double t3435 = d1*t3422*2.0;
                double t3436 = 1.0/(t3408*t3408*t3408);
                double t3437 = t3435-d1*gamma_aa[index]*t3436*2.0;
                v_gamma_aa_gamma_aa_[index] = c*pow(rho_a[index],4.0/3.0)*(t3413*t3423*t3424*t3409*-2.0+gamma_aa[index]* \
                   t3413*t3424*t3409*t3437+t3412*t3413*t3433*t3434*t3409+gamma_aa[index]*t3413*t3423*t3433*t3434*t3409+ \
                   gamma_aa[index]*t3412*t3413*t3434*t3409*(t3410*t3420*t3417*t3429*3.6E1+t3412*t3423*t3415*t3409*3.6E1+ \
                   gamma_aa[index]*(t3423*t3423)*t3415*t3409*1.8E1+(gamma_aa[index]*1.0/(rho_a[index]*rho_a[index]*rho_a[index]* \
                   rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index])*t3417*1.8E1)/t3428-1.0/pow(rho_a[index],3.2E1/ \
                   3.0)*t3410*t3417*t3426*1.0/pow(t3428,3.0/2.0)*1.8E1-gamma_aa[index]*t3412*t3415*t3409*t3437*1.8E1+ \
                   gamma_aa[index]*t3410*t3420*t3412*t3423*t3429*7.2E1)*(1.0/2.0)-gamma_aa[index]*t3412*t3413*(t3433* \
                   t3433)*t3409*1.0/pow(t3419,5.0/2.0)*(3.0/4.0))*2.0;
            } else {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_rho_a_tau_a
            if (rho_a[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else {
                v_rho_a_tau_a_[index] = 0.0;
            } 

            //V_tau_a_tau_a
            if (rho_a[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else {
                v_tau_a_tau_a_[index] = 0.0;
            } 

            if (is_gga_) {

                //V_gamma_aa_tau_a
                if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } 

            }
        }
    }
}
void FT97B_X_Functional::computeUKSFunctional(boost::shared_ptr<UKSFunctions> prop)
{
    int ntrue = prop->npoints();

    const double* restrict rho_a;
    const double* restrict rho_b;
    const double* restrict gamma_aa;
    const double* restrict gamma_ab;
    const double* restrict gamma_bb;
    const double* restrict tau_a;
    const double* restrict tau_b;

    rho_a = prop->property_value("RHO_A")->pointer();
    rho_b = prop->property_value("RHO_B")->pointer();
    if (is_gga_) {
        gamma_aa = prop->property_value("GAMMA_AA")->pointer();
        gamma_ab = prop->property_value("GAMMA_AB")->pointer();
        gamma_bb = prop->property_value("GAMMA_BB")->pointer();
    }
    if (is_meta_) {
        tau_a = prop->property_value("TAU_A")->pointer();
        tau_b = prop->property_value("TAU_B")->pointer();
    }

    double c = params_[0].second;
    double d0 = params_[1].second;
    double d1 = params_[2].second;
    double d2 = params_[3].second;

    //Functional
    for (int index = 0; index < ntrue; index++) {

        //Functional Value
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t2633 = 1.0/pow(rho_a[index],8.0/3.0);
            double t2634 = log(gamma_aa[index]*t2633+sqrt((gamma_aa[index]*gamma_aa[index])*(t2633*t2633)+1.0) \
               );
            double t2636 = d2*d2;
            double t2637 = gamma_aa[index]+t2636;
            double t2638 = 1.0/t2637;
            double t2639 = d1*gamma_aa[index]*t2638;
            double t2635 = d0+t2639;
            double t2640 = 1.0/c;
            double t2641 = 1.0/pow(rho_b[index],8.0/3.0);
            double t2642 = log(gamma_bb[index]*t2641+sqrt((gamma_bb[index]*gamma_bb[index])*(t2641*t2641)+1.0) \
               );
            double t2644 = gamma_bb[index]+t2636;
            double t2645 = 1.0/t2644;
            double t2646 = d1*gamma_bb[index]*t2645;
            double t2643 = d0+t2646;
            functional_[index] = -c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t2640*t2633*t2635*1.0/sqrt(gamma_aa[index]* \
               t2633*(t2634*t2634)*(t2635*t2635)*9.0+1.0)-1.0)-c*pow(rho_b[index],4.0/3.0)*(gamma_bb[index]*t2640* \
               t2641*t2643*1.0/sqrt(gamma_bb[index]*t2641*(t2642*t2642)*(t2643*t2643)*9.0+1.0)-1.0);
        } else if (rho_a[index] > cutoff_) {
            double t3098 = 1.0/pow(rho_a[index],8.0/3.0);
            double t3099 = log(gamma_aa[index]*t3098+sqrt((gamma_aa[index]*gamma_aa[index])*(t3098*t3098)+1.0) \
               );
            double t3101 = d2*d2;
            double t3102 = gamma_aa[index]+t3101;
            double t3103 = 1.0/t3102;
            double t3104 = d1*gamma_aa[index]*t3103;
            double t3100 = d0+t3104;
            functional_[index] = -c*pow(rho_a[index],4.0/3.0)*((gamma_aa[index]*t3098*t3100*1.0/sqrt(gamma_aa[index]* \
               t3098*(t3099*t3099)*(t3100*t3100)*9.0+1.0))/c-1.0);
        } else if (rho_b[index] > cutoff_) {
            double t2931 = 1.0/pow(rho_b[index],8.0/3.0);
            double t2932 = log(gamma_bb[index]*t2931+sqrt((gamma_bb[index]*gamma_bb[index])*(t2931*t2931)+1.0) \
               );
            double t2934 = d2*d2;
            double t2935 = gamma_bb[index]+t2934;
            double t2936 = 1.0/t2935;
            double t2937 = d1*gamma_bb[index]*t2936;
            double t2933 = d0+t2937;
            functional_[index] = -c*pow(rho_b[index],4.0/3.0)*((gamma_bb[index]*t2931*t2933*1.0/sqrt(gamma_bb[index]* \
               t2931*(t2932*t2932)*(t2933*t2933)*9.0+1.0))/c-1.0);
        } else {
            functional_[index] = 0.0;
        } 

    }
    //First Partials
    for (int index = 0; index < ntrue && deriv_ >= 1; index++) {

        //V_rho_a
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t2648 = 1.0/pow(rho_a[index],8.0/3.0);
            double t2656 = gamma_aa[index]*t2648;
            double t2649 = log(t2656+sqrt(t2656*t2656+1.0));
            double t2651 = d2*d2;
            double t2652 = gamma_aa[index]+t2651;
            double t2653 = 1.0/t2652;
            double t2654 = d1*gamma_aa[index]*t2653;
            double t2650 = d0+t2654;
            double t2655 = 1.0/c;
            double t2657 = t2649*t2649;
            double t2658 = t2650*t2650;
            double t2659 = gamma_aa[index]*t2648*t2657*t2658*9.0;
            double t2660 = t2659+1.0;
            double t2661 = 1.0/sqrt(t2660);
            double t2662 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t2663 = gamma_aa[index]*gamma_aa[index];
            v_rho_a_[index] = c*pow(rho_a[index],1.0/3.0)*(gamma_aa[index]*t2650*t2661*t2655*t2648-1.0)*(-4.0/ \
               3.0)+c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t2650*t2661*t2662*t2655*(8.0/3.0)-gamma_aa[index]* \
               t2650*1.0/pow(t2660,3.0/2.0)*t2655*t2648*(gamma_aa[index]*t2662*t2657*t2658*2.4E1+1.0/pow(rho_a[index],1.9E1/ \
               3.0)*t2663*t2649*t2658*1.0/sqrt(1.0/pow(rho_a[index],1.6E1/3.0)*t2663+1.0)*4.8E1)*(1.0/2.0));
        } else if (rho_a[index] > cutoff_) {
            double t3106 = 1.0/pow(rho_a[index],8.0/3.0);
            double t3114 = gamma_aa[index]*t3106;
            double t3107 = log(t3114+sqrt(t3114*t3114+1.0));
            double t3109 = d2*d2;
            double t3110 = gamma_aa[index]+t3109;
            double t3111 = 1.0/t3110;
            double t3112 = d1*gamma_aa[index]*t3111;
            double t3108 = d0+t3112;
            double t3113 = 1.0/c;
            double t3115 = t3107*t3107;
            double t3116 = t3108*t3108;
            double t3117 = gamma_aa[index]*t3106*t3115*t3116*9.0;
            double t3118 = t3117+1.0;
            double t3119 = 1.0/sqrt(t3118);
            double t3120 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t3121 = gamma_aa[index]*gamma_aa[index];
            v_rho_a_[index] = c*pow(rho_a[index],1.0/3.0)*(gamma_aa[index]*t3113*t3106*t3108*t3119-1.0)*(-4.0/ \
               3.0)+c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t3120*t3113*t3108*t3119*(8.0/3.0)-gamma_aa[index]* \
               t3113*t3106*t3108*1.0/pow(t3118,3.0/2.0)*(gamma_aa[index]*t3120*t3115*t3116*2.4E1+1.0/pow(rho_a[index],1.9E1/ \
               3.0)*t3121*t3107*t3116*1.0/sqrt(1.0/pow(rho_a[index],1.6E1/3.0)*t3121+1.0)*4.8E1)*(1.0/2.0));
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_[index] = 0.0;
        } else {
            v_rho_a_[index] = 0.0;
        } 

        //V_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t2665 = 1.0/pow(rho_b[index],8.0/3.0);
            double t2673 = gamma_bb[index]*t2665;
            double t2666 = log(t2673+sqrt(t2673*t2673+1.0));
            double t2668 = d2*d2;
            double t2669 = gamma_bb[index]+t2668;
            double t2670 = 1.0/t2669;
            double t2671 = d1*gamma_bb[index]*t2670;
            double t2667 = d0+t2671;
            double t2672 = 1.0/c;
            double t2674 = t2666*t2666;
            double t2675 = t2667*t2667;
            double t2676 = gamma_bb[index]*t2665*t2674*t2675*9.0;
            double t2677 = t2676+1.0;
            double t2678 = 1.0/sqrt(t2677);
            double t2679 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t2680 = gamma_bb[index]*gamma_bb[index];
            v_rho_b_[index] = c*pow(rho_b[index],1.0/3.0)*(gamma_bb[index]*t2672*t2665*t2667*t2678-1.0)*(-4.0/ \
               3.0)+c*pow(rho_b[index],4.0/3.0)*(gamma_bb[index]*t2672*t2667*t2678*t2679*(8.0/3.0)-gamma_bb[index]* \
               t2672*t2665*t2667*1.0/pow(t2677,3.0/2.0)*(gamma_bb[index]*t2674*t2675*t2679*2.4E1+1.0/pow(rho_b[index],1.9E1/ \
               3.0)*t2680*t2666*t2675*1.0/sqrt(1.0/pow(rho_b[index],1.6E1/3.0)*t2680+1.0)*4.8E1)*(1.0/2.0));
        } else if (rho_a[index] > cutoff_) {
            v_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            double t2940 = 1.0/pow(rho_b[index],8.0/3.0);
            double t2948 = gamma_bb[index]*t2940;
            double t2941 = log(t2948+sqrt(t2948*t2948+1.0));
            double t2943 = d2*d2;
            double t2944 = gamma_bb[index]+t2943;
            double t2945 = 1.0/t2944;
            double t2946 = d1*gamma_bb[index]*t2945;
            double t2942 = d0+t2946;
            double t2947 = 1.0/c;
            double t2949 = t2941*t2941;
            double t2950 = t2942*t2942;
            double t2951 = gamma_bb[index]*t2940*t2950*t2949*9.0;
            double t2952 = t2951+1.0;
            double t2953 = 1.0/sqrt(t2952);
            double t2954 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t2955 = gamma_bb[index]*gamma_bb[index];
            v_rho_b_[index] = c*pow(rho_b[index],1.0/3.0)*(gamma_bb[index]*t2940*t2942*t2953*t2947-1.0)*(-4.0/ \
               3.0)+c*pow(rho_b[index],4.0/3.0)*(gamma_bb[index]*t2942*t2953*t2954*t2947*(8.0/3.0)-gamma_bb[index]* \
               t2940*t2942*1.0/pow(t2952,3.0/2.0)*t2947*(gamma_bb[index]*t2950*t2954*t2949*2.4E1+1.0/pow(rho_b[index],1.9E1/ \
               3.0)*t2941*t2950*t2955*1.0/sqrt(1.0/pow(rho_b[index],1.6E1/3.0)*t2955+1.0)*4.8E1)*(1.0/2.0));
        } else {
            v_rho_b_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t2682 = 1.0/pow(rho_a[index],8.0/3.0);
                double t2690 = gamma_aa[index]*t2682;
                double t2683 = log(t2690+sqrt(t2690*t2690+1.0));
                double t2685 = d2*d2;
                double t2686 = gamma_aa[index]+t2685;
                double t2687 = 1.0/t2686;
                double t2688 = d1*gamma_aa[index]*t2687;
                double t2684 = d0+t2688;
                double t2689 = 1.0/c;
                double t2691 = t2683*t2683;
                double t2692 = t2684*t2684;
                double t2693 = gamma_aa[index]*t2682*t2691*t2692*9.0;
                double t2694 = t2693+1.0;
                double t2695 = 1.0/sqrt(t2694);
                double t2696 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t2697 = d1*t2687;
                double t2698 = 1.0/(t2686*t2686);
                double t2699 = t2697-d1*gamma_aa[index]*t2698;
                v_gamma_aa_[index] = -c*pow(rho_a[index],4.0/3.0)*(t2682*t2684*t2695*t2689+gamma_aa[index]*t2682* \
                   t2695*t2689*t2699-gamma_aa[index]*t2682*t2684*1.0/pow(t2694,3.0/2.0)*t2689*(t2682*t2691*t2692*9.0+ \
                   gamma_aa[index]*t2683*t2692*t2696*1.0/sqrt((gamma_aa[index]*gamma_aa[index])*t2696+1.0)*1.8E1+gamma_aa[index]* \
                   t2682*t2691*t2684*t2699*1.8E1)*(1.0/2.0));
            } else if (rho_a[index] > cutoff_) {
                double t3124 = 1.0/pow(rho_a[index],8.0/3.0);
                double t3132 = gamma_aa[index]*t3124;
                double t3125 = log(t3132+sqrt(t3132*t3132+1.0));
                double t3127 = d2*d2;
                double t3128 = gamma_aa[index]+t3127;
                double t3129 = 1.0/t3128;
                double t3130 = d1*gamma_aa[index]*t3129;
                double t3126 = d0+t3130;
                double t3131 = 1.0/c;
                double t3133 = t3125*t3125;
                double t3134 = t3126*t3126;
                double t3135 = gamma_aa[index]*t3124*t3133*t3134*9.0;
                double t3136 = t3135+1.0;
                double t3137 = 1.0/sqrt(t3136);
                double t3138 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t3139 = d1*t3129;
                double t3140 = 1.0/(t3128*t3128);
                double t3141 = t3139-d1*gamma_aa[index]*t3140;
                v_gamma_aa_[index] = -c*pow(rho_a[index],4.0/3.0)*(t3131*t3124*t3126*t3137+gamma_aa[index]*t3131* \
                   t3141*t3124*t3137-gamma_aa[index]*t3131*t3124*t3126*1.0/pow(t3136,3.0/2.0)*(t3124*t3133*t3134*9.0+ \
                   gamma_aa[index]*t3125*t3134*t3138*1.0/sqrt((gamma_aa[index]*gamma_aa[index])*t3138+1.0)*1.8E1+gamma_aa[index]* \
                   t3141*t3124*t3133*t3126*1.8E1)*(1.0/2.0));
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_[index] = 0.0;
            } else {
                v_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t2702 = 1.0/pow(rho_b[index],8.0/3.0);
                double t2710 = gamma_bb[index]*t2702;
                double t2703 = log(t2710+sqrt(t2710*t2710+1.0));
                double t2705 = d2*d2;
                double t2706 = gamma_bb[index]+t2705;
                double t2707 = 1.0/t2706;
                double t2708 = d1*gamma_bb[index]*t2707;
                double t2704 = d0+t2708;
                double t2709 = 1.0/c;
                double t2711 = t2703*t2703;
                double t2712 = t2704*t2704;
                double t2713 = gamma_bb[index]*t2702*t2711*t2712*9.0;
                double t2714 = t2713+1.0;
                double t2715 = 1.0/sqrt(t2714);
                double t2716 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t2717 = d1*t2707;
                double t2718 = 1.0/(t2706*t2706);
                double t2719 = t2717-d1*gamma_bb[index]*t2718;
                v_gamma_bb_[index] = -c*pow(rho_b[index],4.0/3.0)*(t2702*t2704*t2715*t2709+gamma_bb[index]*t2702* \
                   t2715*t2709*t2719-gamma_bb[index]*t2702*t2704*1.0/pow(t2714,3.0/2.0)*t2709*(t2702*t2711*t2712*9.0+ \
                   gamma_bb[index]*t2703*t2712*t2716*1.0/sqrt((gamma_bb[index]*gamma_bb[index])*t2716+1.0)*1.8E1+gamma_bb[index]* \
                   t2702*t2711*t2704*t2719*1.8E1)*(1.0/2.0));
            } else if (rho_a[index] > cutoff_) {
                v_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t2959 = 1.0/pow(rho_b[index],8.0/3.0);
                double t2967 = gamma_bb[index]*t2959;
                double t2960 = log(t2967+sqrt(t2967*t2967+1.0));
                double t2962 = d2*d2;
                double t2963 = gamma_bb[index]+t2962;
                double t2964 = 1.0/t2963;
                double t2965 = d1*gamma_bb[index]*t2964;
                double t2961 = d0+t2965;
                double t2966 = 1.0/c;
                double t2968 = t2960*t2960;
                double t2969 = t2961*t2961;
                double t2970 = gamma_bb[index]*t2959*t2968*t2969*9.0;
                double t2971 = t2970+1.0;
                double t2972 = 1.0/sqrt(t2971);
                double t2973 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t2974 = d1*t2964;
                double t2975 = 1.0/(t2963*t2963);
                double t2976 = t2974-d1*gamma_bb[index]*t2975;
                v_gamma_bb_[index] = -c*pow(rho_b[index],4.0/3.0)*(t2961*t2972*t2966*t2959+gamma_bb[index]*t2972* \
                   t2966*t2976*t2959-gamma_bb[index]*t2961*1.0/pow(t2971,3.0/2.0)*t2966*t2959*(t2959*t2968*t2969*9.0+ \
                   gamma_bb[index]*t2960*t2973*t2969*1.0/sqrt((gamma_bb[index]*gamma_bb[index])*t2973+1.0)*1.8E1+gamma_bb[index]* \
                   t2961*t2976*t2959*t2968*1.8E1)*(1.0/2.0));
            } else {
                v_gamma_bb_[index] = 0.0;
            } 
        }
        if (is_meta_) {

            //V_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_[index] = 0.0;
            } else {
                v_tau_a_[index] = 0.0;
            } 

            //V_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_b_[index] = 0.0;
            } else {
                v_tau_b_[index] = 0.0;
            } 
        }
    }
    //Second Partials
    for (int index = 0; index < ntrue && deriv_ >= 2; index++) {

        //V_rho_a_rho_a
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t2723 = 1.0/pow(rho_a[index],8.0/3.0);
            double t2731 = gamma_aa[index]*t2723;
            double t2724 = log(t2731+sqrt(t2731*t2731+1.0));
            double t2726 = d2*d2;
            double t2727 = gamma_aa[index]+t2726;
            double t2728 = 1.0/t2727;
            double t2729 = d1*gamma_aa[index]*t2728;
            double t2725 = d0+t2729;
            double t2730 = 1.0/c;
            double t2732 = t2724*t2724;
            double t2733 = t2725*t2725;
            double t2734 = gamma_aa[index]*t2723*t2732*t2733*9.0;
            double t2735 = t2734+1.0;
            double t2736 = 1.0/sqrt(t2735);
            double t2737 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t2738 = gamma_aa[index]*gamma_aa[index];
            double t2739 = 1.0/pow(t2735,3.0/2.0);
            double t2740 = 1.0/pow(rho_a[index],1.4E1/3.0);
            double t2741 = 1.0/pow(rho_a[index],1.6E1/3.0);
            double t2742 = t2741*t2738;
            double t2743 = t2742+1.0;
            double t2744 = 1.0/sqrt(t2743);
            double t2745 = gamma_aa[index]*t2732*t2733*t2737*2.4E1;
            double t2746 = 1.0/pow(rho_a[index],1.9E1/3.0);
            double t2747 = t2724*t2733*t2744*t2746*t2738*4.8E1;
            double t2748 = t2745+t2747;
            v_rho_a_rho_a_[index] = c*1.0/pow(rho_a[index],2.0/3.0)*(gamma_aa[index]*t2730*t2723*t2725*t2736- \
               1.0)*(-4.0/9.0)-c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t2730*t2740*t2725*t2736*(8.8E1/9.0)-gamma_aa[index]* \
               t2730*t2725*t2737*t2739*t2748*(8.0/3.0)-gamma_aa[index]*t2730*t2723*t2725*t2739*(gamma_aa[index]*t2740* \
               t2732*t2733*8.8E1+1.0/pow(rho_a[index],2.2E1/3.0)*t2724*t2733*t2744*t2738*4.32E2+(gamma_aa[index]* \
               1.0/pow(rho_a[index],1.0E1)*t2733*t2738*1.28E2)/t2743-1.0/pow(rho_a[index],3.8E1/3.0)*t2724*t2733* \
               1.0/pow(t2743,3.0/2.0)*(t2738*t2738)*1.28E2)*(1.0/2.0)+gamma_aa[index]*t2730*t2723*t2725*1.0/pow(t2735,5.0/ \
               2.0)*(t2748*t2748)*(3.0/4.0))+c*pow(rho_a[index],1.0/3.0)*(gamma_aa[index]*t2730*t2725*t2736*t2737* \
               (8.0/3.0)-gamma_aa[index]*t2730*t2723*t2725*t2739*t2748*(1.0/2.0))*(8.0/3.0);
        } else if (rho_a[index] > cutoff_) {
            double t3147 = 1.0/pow(rho_a[index],8.0/3.0);
            double t3155 = gamma_aa[index]*t3147;
            double t3148 = log(t3155+sqrt(t3155*t3155+1.0));
            double t3150 = d2*d2;
            double t3151 = gamma_aa[index]+t3150;
            double t3152 = 1.0/t3151;
            double t3153 = d1*gamma_aa[index]*t3152;
            double t3149 = d0+t3153;
            double t3154 = 1.0/c;
            double t3156 = t3148*t3148;
            double t3157 = t3149*t3149;
            double t3158 = gamma_aa[index]*t3147*t3156*t3157*9.0;
            double t3159 = t3158+1.0;
            double t3160 = 1.0/sqrt(t3159);
            double t3161 = 1.0/pow(rho_a[index],1.1E1/3.0);
            double t3162 = gamma_aa[index]*gamma_aa[index];
            double t3163 = 1.0/pow(t3159,3.0/2.0);
            double t3164 = 1.0/pow(rho_a[index],1.4E1/3.0);
            double t3165 = 1.0/pow(rho_a[index],1.6E1/3.0);
            double t3166 = t3162*t3165;
            double t3167 = t3166+1.0;
            double t3168 = 1.0/sqrt(t3167);
            double t3169 = gamma_aa[index]*t3161*t3156*t3157*2.4E1;
            double t3170 = 1.0/pow(rho_a[index],1.9E1/3.0);
            double t3171 = t3170*t3162*t3148*t3157*t3168*4.8E1;
            double t3172 = t3171+t3169;
            v_rho_a_rho_a_[index] = c*1.0/pow(rho_a[index],2.0/3.0)*(gamma_aa[index]*t3160*t3154*t3147*t3149- \
               1.0)*(-4.0/9.0)-c*pow(rho_a[index],4.0/3.0)*(gamma_aa[index]*t3160*t3154*t3164*t3149*(8.8E1/9.0)-gamma_aa[index]* \
               t3161*t3154*t3163*t3172*t3149*(8.0/3.0)-gamma_aa[index]*t3154*t3163*t3147*t3149*(gamma_aa[index]*t3164* \
               t3156*t3157*8.8E1+1.0/pow(rho_a[index],2.2E1/3.0)*t3162*t3148*t3157*t3168*4.32E2+(gamma_aa[index]* \
               1.0/pow(rho_a[index],1.0E1)*t3162*t3157*1.28E2)/t3167-1.0/pow(rho_a[index],3.8E1/3.0)*(t3162*t3162) \
               *t3148*t3157*1.0/pow(t3167,3.0/2.0)*1.28E2)*(1.0/2.0)+gamma_aa[index]*t3154*(t3172*t3172)*t3147*t3149* \
               1.0/pow(t3159,5.0/2.0)*(3.0/4.0))+c*pow(rho_a[index],1.0/3.0)*(gamma_aa[index]*t3160*t3161*t3154*t3149* \
               (8.0/3.0)-gamma_aa[index]*t3154*t3163*t3172*t3147*t3149*(1.0/2.0))*(8.0/3.0);
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_rho_a_[index] = 0.0;
        } else {
            v_rho_a_rho_a_[index] = 0.0;
        } 

        //V_rho_a_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else if (rho_a[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            v_rho_a_rho_b_[index] = 0.0;
        } else {
            v_rho_a_rho_b_[index] = 0.0;
        } 

        //V_rho_b_rho_b
        if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
            double t2751 = 1.0/pow(rho_b[index],8.0/3.0);
            double t2759 = gamma_bb[index]*t2751;
            double t2752 = log(t2759+sqrt(t2759*t2759+1.0));
            double t2754 = d2*d2;
            double t2755 = gamma_bb[index]+t2754;
            double t2756 = 1.0/t2755;
            double t2757 = d1*gamma_bb[index]*t2756;
            double t2753 = d0+t2757;
            double t2758 = 1.0/c;
            double t2760 = t2752*t2752;
            double t2761 = t2753*t2753;
            double t2762 = gamma_bb[index]*t2751*t2760*t2761*9.0;
            double t2763 = t2762+1.0;
            double t2764 = 1.0/sqrt(t2763);
            double t2765 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t2766 = gamma_bb[index]*gamma_bb[index];
            double t2767 = 1.0/pow(t2763,3.0/2.0);
            double t2768 = 1.0/pow(rho_b[index],1.4E1/3.0);
            double t2769 = 1.0/pow(rho_b[index],1.6E1/3.0);
            double t2770 = t2766*t2769;
            double t2771 = t2770+1.0;
            double t2772 = 1.0/sqrt(t2771);
            double t2773 = gamma_bb[index]*t2760*t2761*t2765*2.4E1;
            double t2774 = 1.0/pow(rho_b[index],1.9E1/3.0);
            double t2775 = t2752*t2761*t2772*t2774*t2766*4.8E1;
            double t2776 = t2773+t2775;
            v_rho_b_rho_b_[index] = c*1.0/pow(rho_b[index],2.0/3.0)*(gamma_bb[index]*t2751*t2753*t2764*t2758- \
               1.0)*(-4.0/9.0)-c*pow(rho_b[index],4.0/3.0)*(gamma_bb[index]*t2753*t2764*t2758*t2768*(8.8E1/9.0)-gamma_bb[index]* \
               t2753*t2765*t2758*t2767*t2776*(8.0/3.0)-gamma_bb[index]*t2751*t2753*t2758*t2767*(gamma_bb[index]*t2760* \
               t2761*t2768*8.8E1+1.0/pow(rho_b[index],2.2E1/3.0)*t2752*t2761*t2772*t2766*4.32E2+(gamma_bb[index]* \
               1.0/pow(rho_b[index],1.0E1)*t2761*t2766*1.28E2)/t2771-1.0/pow(rho_b[index],3.8E1/3.0)*t2752*t2761* \
               1.0/pow(t2771,3.0/2.0)*(t2766*t2766)*1.28E2)*(1.0/2.0)+gamma_bb[index]*t2751*t2753*1.0/pow(t2763,5.0/ \
               2.0)*t2758*(t2776*t2776)*(3.0/4.0))+c*pow(rho_b[index],1.0/3.0)*(gamma_bb[index]*t2753*t2764*t2765* \
               t2758*(8.0/3.0)-gamma_bb[index]*t2751*t2753*t2758*t2767*t2776*(1.0/2.0))*(8.0/3.0);
        } else if (rho_a[index] > cutoff_) {
            v_rho_b_rho_b_[index] = 0.0;
        } else if (rho_b[index] > cutoff_) {
            double t2982 = 1.0/pow(rho_b[index],8.0/3.0);
            double t2990 = gamma_bb[index]*t2982;
            double t2983 = log(t2990+sqrt(t2990*t2990+1.0));
            double t2985 = d2*d2;
            double t2986 = gamma_bb[index]+t2985;
            double t2987 = 1.0/t2986;
            double t2988 = d1*gamma_bb[index]*t2987;
            double t2984 = d0+t2988;
            double t2989 = 1.0/c;
            double t2991 = t2983*t2983;
            double t2992 = t2984*t2984;
            double t2993 = gamma_bb[index]*t2982*t2991*t2992*9.0;
            double t2994 = t2993+1.0;
            double t2995 = 1.0/sqrt(t2994);
            double t2996 = 1.0/pow(rho_b[index],1.1E1/3.0);
            double t2997 = gamma_bb[index]*gamma_bb[index];
            double t2998 = 1.0/pow(t2994,3.0/2.0);
            double t2999 = 1.0/pow(rho_b[index],1.4E1/3.0);
            double t3000 = 1.0/pow(rho_b[index],1.6E1/3.0);
            double t3001 = t2997*t3000;
            double t3002 = t3001+1.0;
            double t3003 = 1.0/sqrt(t3002);
            double t3004 = gamma_bb[index]*t2991*t2992*t2996*2.4E1;
            double t3005 = 1.0/pow(rho_b[index],1.9E1/3.0);
            double t3006 = t2983*t2992*t2997*t3003*t3005*4.8E1;
            double t3007 = t3004+t3006;
            v_rho_b_rho_b_[index] = c*1.0/pow(rho_b[index],2.0/3.0)*(gamma_bb[index]*t2982*t2984*t2995*t2989- \
               1.0)*(-4.0/9.0)-c*pow(rho_b[index],4.0/3.0)*(gamma_bb[index]*t2984*t2995*t2989*t2999*(8.8E1/9.0)-gamma_bb[index]* \
               t2984*t2996*t2989*t2998*t3007*(8.0/3.0)-gamma_bb[index]*t2982*t2984*t2989*t2998*(gamma_bb[index]*t2991* \
               t2992*t2999*8.8E1+1.0/pow(rho_b[index],2.2E1/3.0)*t2983*t2992*t2997*t3003*4.32E2+(gamma_bb[index]* \
               1.0/pow(rho_b[index],1.0E1)*t2992*t2997*1.28E2)/t3002-1.0/pow(rho_b[index],3.8E1/3.0)*t2983*t2992* \
               (t2997*t2997)*1.0/pow(t3002,3.0/2.0)*1.28E2)*(1.0/2.0)+gamma_bb[index]*t2982*t2984*1.0/pow(t2994,5.0/ \
               2.0)*t2989*(t3007*t3007)*(3.0/4.0))+c*pow(rho_b[index],1.0/3.0)*(gamma_bb[index]*t2984*t2995*t2996* \
               t2989*(8.0/3.0)-gamma_bb[index]*t2982*t2984*t2989*t2998*t3007*(1.0/2.0))*(8.0/3.0);
        } else {
            v_rho_b_rho_b_[index] = 0.0;
        } 

        if (is_gga_) {

            //V_rho_a_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t2778 = 1.0/pow(rho_a[index],8.0/3.0);
                double t2786 = gamma_aa[index]*t2778;
                double t2779 = log(t2786+sqrt(t2786*t2786+1.0));
                double t2781 = d2*d2;
                double t2782 = gamma_aa[index]+t2781;
                double t2783 = 1.0/t2782;
                double t2784 = d1*gamma_aa[index]*t2783;
                double t2780 = d0+t2784;
                double t2785 = 1.0/c;
                double t2787 = t2779*t2779;
                double t2788 = t2780*t2780;
                double t2789 = gamma_aa[index]*t2778*t2787*t2788*9.0;
                double t2790 = t2789+1.0;
                double t2791 = 1.0/sqrt(t2790);
                double t2792 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t2793 = d1*t2783;
                double t2794 = 1.0/(t2782*t2782);
                double t2802 = d1*gamma_aa[index]*t2794;
                double t2795 = t2793-t2802;
                double t2796 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t2797 = gamma_aa[index]*gamma_aa[index];
                double t2798 = t2792*t2797;
                double t2799 = t2798+1.0;
                double t2800 = 1.0/sqrt(t2799);
                double t2801 = 1.0/pow(t2790,3.0/2.0);
                double t2803 = 1.0/pow(rho_a[index],1.9E1/3.0);
                double t2804 = t2778*t2787*t2788*9.0;
                double t2805 = gamma_aa[index]*t2792*t2779*t2788*t2800*1.8E1;
                double t2806 = gamma_aa[index]*t2780*t2795*t2778*t2787*1.8E1;
                double t2807 = t2804+t2805+t2806;
                double t2808 = gamma_aa[index]*t2787*t2796*t2788*2.4E1;
                double t2809 = t2779*t2788*t2797*t2800*t2803*4.8E1;
                double t2810 = t2808+t2809;
                v_rho_a_gamma_aa_[index] = -c*pow(rho_a[index],4.0/3.0)*(t2780*t2791*t2785*t2796*(-8.0/3.0)-gamma_aa[index]* \
                   t2791*t2785*t2795*t2796*(8.0/3.0)+t2780*t2785*t2778*t2801*t2810*(1.0/2.0)+gamma_aa[index]*t2780*t2785* \
                   t2796*t2801*t2807*(4.0/3.0)+gamma_aa[index]*t2785*t2795*t2778*t2801*t2810*(1.0/2.0)+gamma_aa[index]* \
                   t2780*t2785*t2778*t2801*(t2787*t2796*t2788*2.4E1+(1.0/(rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]* \
                   rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index])*t2788*t2797*4.8E1)/t2799+gamma_aa[index]* \
                   t2780*t2795*t2787*t2796*4.8E1+gamma_aa[index]*t2779*t2788*t2800*t2803*1.44E2+t2780*t2795*t2779*t2797* \
                   t2800*t2803*9.6E1-gamma_aa[index]*1.0/pow(rho_a[index],3.5E1/3.0)*t2779*t2788*t2797*1.0/pow(t2799,3.0/ \
                   2.0)*4.8E1)*(1.0/2.0)-gamma_aa[index]*t2780*1.0/pow(t2790,5.0/2.0)*t2785*t2778*t2810*t2807*(3.0/4.0) \
                   )-c*pow(rho_a[index],1.0/3.0)*(t2780*t2791*t2785*t2778+gamma_aa[index]*t2791*t2785*t2795*t2778-gamma_aa[index]* \
                   t2780*t2785*t2778*t2801*t2807*(1.0/2.0))*(4.0/3.0);
            } else if (rho_a[index] > cutoff_) {
                double t3176 = 1.0/pow(rho_a[index],8.0/3.0);
                double t3184 = gamma_aa[index]*t3176;
                double t3177 = log(t3184+sqrt(t3184*t3184+1.0));
                double t3179 = d2*d2;
                double t3180 = gamma_aa[index]+t3179;
                double t3181 = 1.0/t3180;
                double t3182 = d1*gamma_aa[index]*t3181;
                double t3178 = d0+t3182;
                double t3183 = 1.0/c;
                double t3185 = t3177*t3177;
                double t3186 = t3178*t3178;
                double t3187 = gamma_aa[index]*t3176*t3185*t3186*9.0;
                double t3188 = t3187+1.0;
                double t3189 = 1.0/sqrt(t3188);
                double t3190 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t3191 = d1*t3181;
                double t3192 = 1.0/(t3180*t3180);
                double t3200 = d1*gamma_aa[index]*t3192;
                double t3193 = t3191-t3200;
                double t3194 = 1.0/pow(rho_a[index],1.1E1/3.0);
                double t3195 = gamma_aa[index]*gamma_aa[index];
                double t3196 = t3190*t3195;
                double t3197 = t3196+1.0;
                double t3198 = 1.0/sqrt(t3197);
                double t3199 = 1.0/pow(t3188,3.0/2.0);
                double t3201 = 1.0/pow(rho_a[index],1.9E1/3.0);
                double t3202 = t3176*t3185*t3186*9.0;
                double t3203 = gamma_aa[index]*t3190*t3177*t3186*t3198*1.8E1;
                double t3204 = gamma_aa[index]*t3193*t3176*t3185*t3178*1.8E1;
                double t3205 = t3202+t3203+t3204;
                double t3206 = gamma_aa[index]*t3185*t3194*t3186*2.4E1;
                double t3207 = t3177*t3186*t3195*t3198*t3201*4.8E1;
                double t3208 = t3206+t3207;
                v_rho_a_gamma_aa_[index] = -c*pow(rho_a[index],4.0/3.0)*(t3183*t3194*t3178*t3189*(-8.0/3.0)-gamma_aa[index]* \
                   t3183*t3193*t3194*t3189*(8.0/3.0)+t3183*t3176*t3178*t3199*t3208*(1.0/2.0)+gamma_aa[index]*t3183*t3193* \
                   t3176*t3199*t3208*(1.0/2.0)+gamma_aa[index]*t3183*t3194*t3178*t3199*t3205*(4.0/3.0)+gamma_aa[index]* \
                   t3183*t3176*t3178*t3199*(t3185*t3194*t3186*2.4E1+(1.0/(rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]* \
                   rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index])*t3186*t3195*4.8E1)/t3197+gamma_aa[index]* \
                   t3193*t3185*t3194*t3178*4.8E1+gamma_aa[index]*t3177*t3186*t3198*t3201*1.44E2+t3193*t3177*t3195*t3178* \
                   t3198*t3201*9.6E1-gamma_aa[index]*1.0/pow(rho_a[index],3.5E1/3.0)*t3177*t3186*t3195*1.0/pow(t3197,3.0/ \
                   2.0)*4.8E1)*(1.0/2.0)-gamma_aa[index]*t3183*t3176*t3178*1.0/pow(t3188,5.0/2.0)*t3205*t3208*(3.0/4.0) \
                   )-c*pow(rho_a[index],1.0/3.0)*(t3183*t3176*t3178*t3189+gamma_aa[index]*t3183*t3193*t3176*t3189-gamma_aa[index]* \
                   t3183*t3176*t3178*t3199*t3205*(1.0/2.0))*(4.0/3.0);
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_aa_[index] = 0.0;
            } else {
                v_rho_a_gamma_aa_[index] = 0.0;
            } 

            //V_rho_a_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_ab_[index] = 0.0;
            } else {
                v_rho_a_gamma_ab_[index] = 0.0;
            } 

            //V_rho_a_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_gamma_bb_[index] = 0.0;
            } else {
                v_rho_a_gamma_bb_[index] = 0.0;
            } 

            //V_rho_b_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_gamma_aa_[index] = 0.0;
            } else {
                v_rho_b_gamma_aa_[index] = 0.0;
            } 

            //V_rho_b_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_gamma_ab_[index] = 0.0;
            } else {
                v_rho_b_gamma_ab_[index] = 0.0;
            } 

            //V_rho_b_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t2816 = 1.0/pow(rho_b[index],8.0/3.0);
                double t2824 = gamma_bb[index]*t2816;
                double t2817 = log(t2824+sqrt(t2824*t2824+1.0));
                double t2819 = d2*d2;
                double t2820 = gamma_bb[index]+t2819;
                double t2821 = 1.0/t2820;
                double t2822 = d1*gamma_bb[index]*t2821;
                double t2818 = d0+t2822;
                double t2823 = 1.0/c;
                double t2825 = t2817*t2817;
                double t2826 = t2818*t2818;
                double t2827 = gamma_bb[index]*t2816*t2825*t2826*9.0;
                double t2828 = t2827+1.0;
                double t2829 = 1.0/sqrt(t2828);
                double t2830 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t2831 = d1*t2821;
                double t2832 = 1.0/(t2820*t2820);
                double t2840 = d1*gamma_bb[index]*t2832;
                double t2833 = t2831-t2840;
                double t2834 = 1.0/pow(rho_b[index],1.1E1/3.0);
                double t2835 = gamma_bb[index]*gamma_bb[index];
                double t2836 = t2830*t2835;
                double t2837 = t2836+1.0;
                double t2838 = 1.0/sqrt(t2837);
                double t2839 = 1.0/pow(t2828,3.0/2.0);
                double t2841 = 1.0/pow(rho_b[index],1.9E1/3.0);
                double t2842 = t2816*t2825*t2826*9.0;
                double t2843 = gamma_bb[index]*t2830*t2817*t2826*t2838*1.8E1;
                double t2844 = gamma_bb[index]*t2833*t2816*t2825*t2818*1.8E1;
                double t2845 = t2842+t2843+t2844;
                double t2846 = gamma_bb[index]*t2825*t2834*t2826*2.4E1;
                double t2847 = t2841*t2817*t2826*t2835*t2838*4.8E1;
                double t2848 = t2846+t2847;
                v_rho_b_gamma_bb_[index] = -c*pow(rho_b[index],4.0/3.0)*(t2823*t2834*t2818*t2829*(-8.0/3.0)-gamma_bb[index]* \
                   t2823*t2833*t2834*t2829*(8.0/3.0)+t2823*t2816*t2818*t2839*t2848*(1.0/2.0)+gamma_bb[index]*t2823*t2833* \
                   t2816*t2839*t2848*(1.0/2.0)+gamma_bb[index]*t2823*t2834*t2818*t2845*t2839*(4.0/3.0)+gamma_bb[index]* \
                   t2823*t2816*t2818*t2839*(t2825*t2834*t2826*2.4E1+(1.0/(rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index]* \
                   rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index])*t2826*t2835*4.8E1)/t2837+gamma_bb[index]* \
                   t2833*t2825*t2834*t2818*4.8E1+gamma_bb[index]*t2841*t2817*t2826*t2838*1.44E2+t2841*t2833*t2817*t2835* \
                   t2818*t2838*9.6E1-gamma_bb[index]*1.0/pow(rho_b[index],3.5E1/3.0)*t2817*t2826*t2835*1.0/pow(t2837,3.0/ \
                   2.0)*4.8E1)*(1.0/2.0)-gamma_bb[index]*t2823*t2816*t2818*t2845*1.0/pow(t2828,5.0/2.0)*t2848*(3.0/4.0) \
                   )-c*pow(rho_b[index],1.0/3.0)*(t2823*t2816*t2818*t2829+gamma_bb[index]*t2823*t2833*t2816*t2829-gamma_bb[index]* \
                   t2823*t2816*t2818*t2845*t2839*(1.0/2.0))*(4.0/3.0);
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t3014 = 1.0/pow(rho_b[index],8.0/3.0);
                double t3022 = gamma_bb[index]*t3014;
                double t3015 = log(t3022+sqrt(t3022*t3022+1.0));
                double t3017 = d2*d2;
                double t3018 = gamma_bb[index]+t3017;
                double t3019 = 1.0/t3018;
                double t3020 = d1*gamma_bb[index]*t3019;
                double t3016 = d0+t3020;
                double t3021 = 1.0/c;
                double t3023 = t3015*t3015;
                double t3024 = t3016*t3016;
                double t3025 = gamma_bb[index]*t3014*t3023*t3024*9.0;
                double t3026 = t3025+1.0;
                double t3027 = 1.0/sqrt(t3026);
                double t3028 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t3029 = d1*t3019;
                double t3030 = 1.0/(t3018*t3018);
                double t3038 = d1*gamma_bb[index]*t3030;
                double t3031 = t3029-t3038;
                double t3032 = 1.0/pow(rho_b[index],1.1E1/3.0);
                double t3033 = gamma_bb[index]*gamma_bb[index];
                double t3034 = t3033*t3028;
                double t3035 = t3034+1.0;
                double t3036 = 1.0/sqrt(t3035);
                double t3037 = 1.0/pow(t3026,3.0/2.0);
                double t3039 = 1.0/pow(rho_b[index],1.9E1/3.0);
                double t3040 = t3014*t3023*t3024*9.0;
                double t3041 = gamma_bb[index]*t3015*t3024*t3036*t3028*1.8E1;
                double t3042 = gamma_bb[index]*t3031*t3014*t3023*t3016*1.8E1;
                double t3043 = t3040+t3041+t3042;
                double t3044 = gamma_bb[index]*t3023*t3032*t3024*2.4E1;
                double t3045 = t3015*t3024*t3033*t3036*t3039*4.8E1;
                double t3046 = t3044+t3045;
                v_rho_b_gamma_bb_[index] = -c*pow(rho_b[index],4.0/3.0)*(t3021*t3032*t3016*t3027*(-8.0/3.0)-gamma_bb[index]* \
                   t3021*t3031*t3032*t3027*(8.0/3.0)+t3021*t3014*t3016*t3037*t3046*(1.0/2.0)+gamma_bb[index]*t3021*t3031* \
                   t3014*t3037*t3046*(1.0/2.0)+gamma_bb[index]*t3021*t3032*t3016*t3043*t3037*(4.0/3.0)+gamma_bb[index]* \
                   t3021*t3014*t3016*t3037*(t3023*t3032*t3024*2.4E1+(1.0/(rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index]* \
                   rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index])*t3024*t3033*4.8E1)/t3035+gamma_bb[index]* \
                   t3031*t3023*t3032*t3016*4.8E1+gamma_bb[index]*t3015*t3024*t3036*t3039*1.44E2+t3031*t3015*t3033*t3016* \
                   t3036*t3039*9.6E1-gamma_bb[index]*1.0/pow(rho_b[index],3.5E1/3.0)*t3015*t3024*t3033*1.0/pow(t3035,3.0/ \
                   2.0)*4.8E1)*(1.0/2.0)-gamma_bb[index]*t3021*t3014*t3016*t3043*1.0/pow(t3026,5.0/2.0)*t3046*(3.0/4.0) \
                   )-c*pow(rho_b[index],1.0/3.0)*(t3021*t3014*t3016*t3027+gamma_bb[index]*t3021*t3031*t3014*t3027-gamma_bb[index]* \
                   t3021*t3014*t3016*t3043*t3037*(1.0/2.0))*(4.0/3.0);
            } else {
                v_rho_b_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_aa
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t2850 = d2*d2;
                double t2851 = gamma_aa[index]+t2850;
                double t2852 = 1.0/pow(rho_a[index],8.0/3.0);
                double t2857 = gamma_aa[index]*t2852;
                double t2853 = log(t2857+sqrt(t2857*t2857+1.0));
                double t2854 = 1.0/t2851;
                double t2859 = d1*gamma_aa[index]*t2854;
                double t2855 = d0+t2859;
                double t2856 = 1.0/c;
                double t2858 = t2853*t2853;
                double t2860 = t2855*t2855;
                double t2861 = gamma_aa[index]*t2860*t2852*t2858*9.0;
                double t2862 = t2861+1.0;
                double t2863 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t2864 = d1*t2854;
                double t2865 = 1.0/(t2851*t2851);
                double t2874 = d1*gamma_aa[index]*t2865;
                double t2866 = t2864-t2874;
                double t2867 = 1.0/sqrt(t2862);
                double t2868 = t2860*t2852*t2858*9.0;
                double t2869 = gamma_aa[index]*gamma_aa[index];
                double t2870 = t2863*t2869;
                double t2871 = t2870+1.0;
                double t2872 = 1.0/sqrt(t2871);
                double t2873 = gamma_aa[index]*t2860*t2853*t2863*t2872*1.8E1;
                double t2875 = gamma_aa[index]*t2852*t2855*t2866*t2858*1.8E1;
                double t2876 = t2873+t2875+t2868;
                double t2877 = 1.0/pow(t2862,3.0/2.0);
                double t2878 = d1*t2865*2.0;
                double t2879 = 1.0/(t2851*t2851*t2851);
                double t2880 = t2878-d1*gamma_aa[index]*t2879*2.0;
                v_gamma_aa_gamma_aa_[index] = c*pow(rho_a[index],4.0/3.0)*(t2852*t2856*t2866*t2867*-2.0+gamma_aa[index]* \
                   t2852*t2880*t2856*t2867+t2852*t2855*t2856*t2876*t2877+gamma_aa[index]*t2852*t2856*t2866*t2876*t2877+ \
                   gamma_aa[index]*t2852*t2855*t2856*t2877*(t2860*t2853*t2863*t2872*3.6E1+t2852*t2855*t2866*t2858*3.6E1+ \
                   gamma_aa[index]*t2852*(t2866*t2866)*t2858*1.8E1+(gamma_aa[index]*1.0/(rho_a[index]*rho_a[index]*rho_a[index]* \
                   rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index])*t2860*1.8E1)/t2871-1.0/pow(rho_a[index],3.2E1/ \
                   3.0)*t2860*t2853*1.0/pow(t2871,3.0/2.0)*t2869*1.8E1-gamma_aa[index]*t2852*t2880*t2855*t2858*1.8E1+ \
                   gamma_aa[index]*t2853*t2863*t2872*t2855*t2866*7.2E1)*(1.0/2.0)-gamma_aa[index]*t2852*1.0/pow(t2862,5.0/ \
                   2.0)*t2855*t2856*(t2876*t2876)*(3.0/4.0));
            } else if (rho_a[index] > cutoff_) {
                double t3215 = d2*d2;
                double t3216 = gamma_aa[index]+t3215;
                double t3217 = 1.0/pow(rho_a[index],8.0/3.0);
                double t3222 = gamma_aa[index]*t3217;
                double t3218 = log(t3222+sqrt(t3222*t3222+1.0));
                double t3219 = 1.0/t3216;
                double t3224 = d1*gamma_aa[index]*t3219;
                double t3220 = d0+t3224;
                double t3221 = 1.0/c;
                double t3223 = t3218*t3218;
                double t3225 = t3220*t3220;
                double t3226 = gamma_aa[index]*t3223*t3225*t3217*9.0;
                double t3227 = t3226+1.0;
                double t3228 = 1.0/pow(rho_a[index],1.6E1/3.0);
                double t3229 = d1*t3219;
                double t3230 = 1.0/(t3216*t3216);
                double t3239 = d1*gamma_aa[index]*t3230;
                double t3231 = t3229-t3239;
                double t3232 = 1.0/sqrt(t3227);
                double t3233 = t3223*t3225*t3217*9.0;
                double t3234 = gamma_aa[index]*gamma_aa[index];
                double t3235 = t3234*t3228;
                double t3236 = t3235+1.0;
                double t3237 = 1.0/sqrt(t3236);
                double t3238 = gamma_aa[index]*t3225*t3218*t3228*t3237*1.8E1;
                double t3240 = gamma_aa[index]*t3220*t3231*t3223*t3217*1.8E1;
                double t3241 = t3240+t3233+t3238;
                double t3242 = 1.0/pow(t3227,3.0/2.0);
                double t3243 = d1*t3230*2.0;
                double t3244 = 1.0/(t3216*t3216*t3216);
                double t3245 = t3243-d1*gamma_aa[index]*t3244*2.0;
                v_gamma_aa_gamma_aa_[index] = c*pow(rho_a[index],4.0/3.0)*(t3221*t3231*t3232*t3217*-2.0+gamma_aa[index]* \
                   t3221*t3232*t3217*t3245+t3220*t3221*t3241*t3242*t3217+gamma_aa[index]*t3221*t3231*t3241*t3242*t3217+ \
                   gamma_aa[index]*t3220*t3221*t3242*t3217*(t3220*t3231*t3223*t3217*3.6E1+t3225*t3218*t3228*t3237*3.6E1+ \
                   gamma_aa[index]*(t3231*t3231)*t3223*t3217*1.8E1+(gamma_aa[index]*1.0/(rho_a[index]*rho_a[index]*rho_a[index]* \
                   rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index]*rho_a[index])*t3225*1.8E1)/t3236-1.0/pow(rho_a[index],3.2E1/ \
                   3.0)*t3225*t3234*t3218*1.0/pow(t3236,3.0/2.0)*1.8E1-gamma_aa[index]*t3220*t3223*t3217*t3245*1.8E1+ \
                   gamma_aa[index]*t3220*t3231*t3218*t3228*t3237*7.2E1)*(1.0/2.0)-gamma_aa[index]*t3220*t3221*(t3241* \
                   t3241)*t3217*1.0/pow(t3227,5.0/2.0)*(3.0/4.0));
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_aa_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_aa_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } else {
                v_gamma_aa_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_ab_gamma_ab
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } else {
                v_gamma_ab_gamma_ab_[index] = 0.0;
            } 

            //V_gamma_ab_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } else {
                v_gamma_ab_gamma_bb_[index] = 0.0;
            } 

            //V_gamma_bb_gamma_bb
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                double t2886 = d2*d2;
                double t2887 = gamma_bb[index]+t2886;
                double t2888 = 1.0/pow(rho_b[index],8.0/3.0);
                double t2893 = gamma_bb[index]*t2888;
                double t2889 = log(t2893+sqrt(t2893*t2893+1.0));
                double t2890 = 1.0/t2887;
                double t2895 = d1*gamma_bb[index]*t2890;
                double t2891 = d0+t2895;
                double t2892 = 1.0/c;
                double t2894 = t2889*t2889;
                double t2896 = t2891*t2891;
                double t2897 = gamma_bb[index]*t2894*t2896*t2888*9.0;
                double t2898 = t2897+1.0;
                double t2899 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t2900 = d1*t2890;
                double t2901 = 1.0/(t2887*t2887);
                double t2910 = d1*gamma_bb[index]*t2901;
                double t2902 = t2900-t2910;
                double t2903 = 1.0/sqrt(t2898);
                double t2904 = t2894*t2896*t2888*9.0;
                double t2905 = gamma_bb[index]*gamma_bb[index];
                double t2906 = t2899*t2905;
                double t2907 = t2906+1.0;
                double t2908 = 1.0/sqrt(t2907);
                double t2909 = gamma_bb[index]*t2896*t2889*t2899*t2908*1.8E1;
                double t2911 = gamma_bb[index]*t2891*t2894*t2888*t2902*1.8E1;
                double t2912 = t2911+t2904+t2909;
                double t2913 = 1.0/pow(t2898,3.0/2.0);
                double t2914 = d1*t2901*2.0;
                double t2915 = 1.0/(t2887*t2887*t2887);
                double t2916 = t2914-d1*gamma_bb[index]*t2915*2.0;
                v_gamma_bb_gamma_bb_[index] = c*pow(rho_b[index],4.0/3.0)*(t2892*t2888*t2902*t2903*-2.0+gamma_bb[index]* \
                   t2892*t2888*t2903*t2916+t2891*t2892*t2888*t2912*t2913+gamma_bb[index]*t2892*t2888*t2902*t2912*t2913+ \
                   gamma_bb[index]*t2891*t2892*t2888*t2913*(t2891*t2894*t2888*t2902*3.6E1+t2896*t2889*t2899*t2908*3.6E1+ \
                   gamma_bb[index]*t2894*t2888*(t2902*t2902)*1.8E1+(gamma_bb[index]*1.0/(rho_b[index]*rho_b[index]*rho_b[index]* \
                   rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index])*t2896*1.8E1)/t2907-1.0/pow(rho_b[index],3.2E1/ \
                   3.0)*t2896*t2889*t2905*1.0/pow(t2907,3.0/2.0)*1.8E1-gamma_bb[index]*t2891*t2894*t2888*t2916*1.8E1+ \
                   gamma_bb[index]*t2891*t2889*t2899*t2902*t2908*7.2E1)*(1.0/2.0)-gamma_bb[index]*t2891*t2892*t2888*1.0/ \
                   pow(t2898,5.0/2.0)*(t2912*t2912)*(3.0/4.0));
            } else if (rho_a[index] > cutoff_) {
                v_gamma_bb_gamma_bb_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                double t3053 = d2*d2;
                double t3054 = gamma_bb[index]+t3053;
                double t3055 = 1.0/pow(rho_b[index],8.0/3.0);
                double t3060 = gamma_bb[index]*t3055;
                double t3056 = log(t3060+sqrt(t3060*t3060+1.0));
                double t3057 = 1.0/t3054;
                double t3062 = d1*gamma_bb[index]*t3057;
                double t3058 = d0+t3062;
                double t3059 = 1.0/c;
                double t3061 = t3056*t3056;
                double t3063 = t3058*t3058;
                double t3064 = gamma_bb[index]*t3061*t3063*t3055*9.0;
                double t3065 = t3064+1.0;
                double t3066 = 1.0/pow(rho_b[index],1.6E1/3.0);
                double t3067 = d1*t3057;
                double t3068 = 1.0/(t3054*t3054);
                double t3077 = d1*gamma_bb[index]*t3068;
                double t3069 = t3067-t3077;
                double t3070 = 1.0/sqrt(t3065);
                double t3071 = t3061*t3063*t3055*9.0;
                double t3072 = gamma_bb[index]*gamma_bb[index];
                double t3073 = t3072*t3066;
                double t3074 = t3073+1.0;
                double t3075 = 1.0/sqrt(t3074);
                double t3076 = gamma_bb[index]*t3063*t3056*t3066*t3075*1.8E1;
                double t3078 = gamma_bb[index]*t3061*t3055*t3058*t3069*1.8E1;
                double t3079 = t3071+t3076+t3078;
                double t3080 = 1.0/pow(t3065,3.0/2.0);
                double t3081 = d1*t3068*2.0;
                double t3082 = 1.0/(t3054*t3054*t3054);
                double t3083 = t3081-d1*gamma_bb[index]*t3082*2.0;
                v_gamma_bb_gamma_bb_[index] = c*pow(rho_b[index],4.0/3.0)*(t3070*t3055*t3059*t3069*-2.0+gamma_bb[index]* \
                   t3070*t3055*t3083*t3059+t3080*t3055*t3058*t3059*t3079+gamma_bb[index]*t3080*t3055*t3059*t3069*t3079+ \
                   gamma_bb[index]*t3080*t3055*t3058*t3059*(t3063*t3056*t3066*t3075*3.6E1+t3061*t3055*t3058*t3069*3.6E1+ \
                   gamma_bb[index]*t3061*t3055*(t3069*t3069)*1.8E1+(gamma_bb[index]*1.0/(rho_b[index]*rho_b[index]*rho_b[index]* \
                   rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index]*rho_b[index])*t3063*1.8E1)/t3074-1.0/pow(rho_b[index],3.2E1/ \
                   3.0)*t3063*t3072*t3056*1.0/pow(t3074,3.0/2.0)*1.8E1-gamma_bb[index]*t3061*t3055*t3083*t3058*1.8E1+ \
                   gamma_bb[index]*t3056*t3066*t3075*t3058*t3069*7.2E1)*(1.0/2.0)-gamma_bb[index]*t3055*1.0/pow(t3065,5.0/ \
                   2.0)*t3058*t3059*(t3079*t3079)*(3.0/4.0));
            } else {
                v_gamma_bb_gamma_bb_[index] = 0.0;
            } 

        }
        if (is_meta_) {

            //V_rho_a_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_tau_a_[index] = 0.0;
            } else {
                v_rho_a_tau_a_[index] = 0.0;
            } 

            //V_rho_a_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_a_tau_b_[index] = 0.0;
            } else {
                v_rho_a_tau_b_[index] = 0.0;
            } 

            //V_rho_b_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_tau_a_[index] = 0.0;
            } else {
                v_rho_b_tau_a_[index] = 0.0;
            } 

            //V_rho_b_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_rho_b_tau_b_[index] = 0.0;
            } else {
                v_rho_b_tau_b_[index] = 0.0;
            } 

            //V_tau_a_tau_a
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_tau_a_[index] = 0.0;
            } else {
                v_tau_a_tau_a_[index] = 0.0;
            } 

            //V_tau_a_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_a_tau_b_[index] = 0.0;
            } else {
                v_tau_a_tau_b_[index] = 0.0;
            } 

            //V_tau_b_tau_b
            if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else if (rho_a[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else if (rho_b[index] > cutoff_) {
                v_tau_b_tau_b_[index] = 0.0;
            } else {
                v_tau_b_tau_b_[index] = 0.0;
            } 

            if (is_gga_) {

                //V_gamma_aa_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_a_[index] = 0.0;
                } 

                //V_gamma_aa_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } else {
                    v_gamma_aa_tau_b_[index] = 0.0;
                } 

                //V_gamma_ab_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } else {
                    v_gamma_ab_tau_a_[index] = 0.0;
                } 

                //V_gamma_ab_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } else {
                    v_gamma_ab_tau_b_[index] = 0.0;
                } 

                //V_gamma_bb_tau_a
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } else {
                    v_gamma_bb_tau_a_[index] = 0.0;
                } 

                //V_gamma_bb_tau_b
                if (rho_a[index] > cutoff_ && rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else if (rho_a[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else if (rho_b[index] > cutoff_) {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } else {
                    v_gamma_bb_tau_b_[index] = 0.0;
                } 

            }
        }
    }
}

}}

