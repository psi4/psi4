#! Scan fractional occupation of electrons
#! updated values due to new BraggSlater radii
 

# from 1.0.24
ref = { 1.0: -7.6425138025062068E+01,  #   3.0421363965287055E-02
        0.9: -7.6395298499753324E+01,  #   3.0755028948333162E-02
        0.8: -7.6398395772169437E+01,  #   3.1174774608338278E-02
        0.7: -7.6401544246937021E+01,  #   3.1892559199593946E-02
        0.6: -7.6404823679365293E+01,  #   3.3604606828099313E-02
        0.5: -7.6408214906395841E+01,  #   3.4113927359810871E-02
        0.4: -7.6411633057284902E+01,  #   3.4197092075376301E-02
        0.3: -7.6415045048785416E+01,  #   3.3999215606009284E-02
        0.2: -7.6418424644320055E+01,  #   3.3555834057390335E-02
        0.1: -7.6421753678180238E+01,  #   3.3071268730323074E-02
        0.0: -7.6425138025062026E+01,  #   3.8841483131591061E-02
        #0.0:-7.6425138025062068E+01,  #  -4.3645877523402798E-01
       -0.1: -7.6381260222981723E+01,  #  -4.4117692264348390E-01
       -0.2: -7.6336888317392877E+01,  #  -4.4632257817871113E-01
       -0.3: -7.6291985612708800E+01,  #  -4.5177342565995471E-01
       -0.4: -7.6246528343431692E+01,  #  -4.5739123547584976E-01
       -0.5: -7.6200507815519558E+01,  #  -4.6300924391350834E-01
       -0.6: -7.6153933880559464E+01,  #  -4.6842138822042823E-01
       -0.7: -7.6106838679575105E+01,  #  -4.7339421419353644E-01
       -0.8: -7.6059276316828672E+01,  #  -4.7774529389059461E-01
       -0.9: -7.6011309871054394E+01,  #  -4.8150651399352440E-01
       -1.0: -7.5962988674251491E+01,  #  -4.8483191493648548E-01
}

molecule h2o {
0 1  # must be neutral
O
H 1 1.0
H 1 1.0 2 104.5
# FRAC jobs will be be run in C1 symmetry
}

set {
reference uks  # UKS, as we need to do all kinds of weird stuff
basis aug-cc-pvdz  # Augmented functions are very important on the anion side
scf_type df
}

# Argument is functional.
# Many optional arguments are available, see the python file
E = frac_traverse('wb97', molecule=h2o)
for occ, ene in E.items():
    occ = round(occ, 1)
    if occ != 1.0:
        compare_values(ref[occ], ene, 6, 'Frac Occ Ene: ' + str(occ))  #TEST
compare_values(ref[1.0], E[1.0], 1, 'Frac Occ Ene: 1.0 BAD UN')  #TEST
