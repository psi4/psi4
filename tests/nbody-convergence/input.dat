#! Computation of water trimer gradients (geometry from J. Chem. Theory Comput. 11, 2126-2136 (2015))

gradients = {} #TEST

gradients['NoCP_cc-pV[D, T]Z'] = [ #TEST
[-0.00161712162231,     0.00397356392398,    -0.00055253860837], #TEST
[ 0.00504360782128,    -0.00281087786046,     0.00018612225717], #TEST
[-0.00113999839704,    -0.00042223788224,     0.00061503806174], #TEST
[-0.00249581829630,    -0.00365667862949,    -0.00062733918280], #TEST
[ 0.00107540599930,    -0.00078182703602,     0.00059159625154], #TEST
[-0.00029079787019,     0.00615533362786,     0.00024796425548], #TEST
[ 0.00437118223131,    -0.00042281908453,     0.00022012956887], #TEST
[-0.00515699830171,    -0.00322587123912,    -0.00015350319263], #TEST
[ 0.00021053843766,     0.00119141417999,    -0.00052746941092], #TEST
] #TEST

gradients['NoCP_cc-pV[T, Q]Z'] = [
[-0.00201023630443,     0.00550407890882,    -0.00214187279674], #TEST
[ 0.00611000361211,    -0.00258835873337,     0.00031106509025], #TEST
[-0.00150989323869,    -0.00139651812715,     0.00186215863679], #TEST
[-0.00363671913057,    -0.00473727051158,    -0.00208879128055], #TEST
[ 0.00203833177435,    -0.00058829293587,     0.00180529250813], #TEST
[-0.00097842272305,     0.00681648942769,     0.00052805609234], #TEST
[ 0.00583735434654,    -0.00079144214316,     0.00212363060113], #TEST
[-0.00538786265203,    -0.00421049776019,    -0.00040531063829], #TEST
[-0.00046255567916,     0.00199181187437,    -0.00199422821343], #TEST
]

gradients['CP_cc-pV[D, T]Z'] = [ #TEST
[-0.00087631220747,     0.00443341294891,    -0.00120415700496], #TEST
[ 0.00618551913333,    -0.00230619284206,    -0.00030756983706], #TEST
[-0.00147813243186,    -0.00023541181481,     0.00138410577596], #TEST
[-0.00325108815667,    -0.00319121782581,    -0.00103644856403], #TEST
[ 0.00106447324291,    -0.00118919345117,     0.00135119458673], #TEST
[-0.00132766134200,     0.00689407347032,    -0.00029327191679], #TEST
[ 0.00442501064524,    -0.00137193358290,     0.00098128668027], #TEST
[-0.00525973650781,    -0.00442822597784,     0.00056456869334], #TEST
[ 0.00051792762617,     0.00139468907558,    -0.00143970841378], #TEST
] #TEST

gradients['CP_cc-pV[T, Q]Z'] = [ #TEST
[-0.00161321194285,     0.00558317016944,    -0.00245105027017], #TEST
[ 0.00644170572211,    -0.00254954209147,     0.00012436819369], #TEST
[-0.00158560062905,    -0.00117607664279,     0.00216637216164], #TEST
[-0.00392857121648,    -0.00442407454382,    -0.00225140703442], #TEST
[ 0.00194277506382,    -0.00076528435085,     0.00214187338979], #TEST
[-0.00119929528192,     0.00714346218804,     0.00017455603551], #TEST
[ 0.00572902568196,    -0.00118211097206,     0.00238530920393], #TEST
[-0.00554945372110,    -0.00451372077558,    -0.00000397258313], #TEST
[-0.00023737367209,     0.00188417701814,    -0.00228604909771], #TEST
] #TEST

gradients['VMFC_cc-pV[D, T]Z'] = [ #TEST
[-0.00092761705447,     0.00466052851184,    -0.00130283684930], #TEST
[ 0.00668392117802,    -0.00235918080042,    -0.00019765394317], #TEST
[-0.00153729770672,    -0.00014795961576,     0.00146346144361], #TEST
[-0.00336968392591,    -0.00331330105299,    -0.00125563672558], #TEST
[ 0.00101105151634,    -0.00129448298115,     0.00141807707029], #TEST
[-0.00155035753018,     0.00732355737541,    -0.00022163039437], #TEST
[ 0.00463860264367,    -0.00139753550192,     0.00108979700882], #TEST
[-0.00556480033546,    -0.00487973460985,     0.00052242110554], #TEST
[ 0.00061618121681,     0.00140810867464,    -0.00151599871578], #TEST
]

gradients['VMFC_cc-pV[T, Q]Z'] = [ #TEST
[-0.00166572307177,     0.00565659163491,    -0.00251487040417], #TEST
[ 0.00661484005595,    -0.00263313341858,     0.00018339518836], #TEST
[-0.00160430688292,    -0.00113031247814,     0.00221483475913], #TEST
[-0.00393654673092,    -0.00448609423111,    -0.00239631943440], #TEST
[ 0.00190073642927,    -0.00080389189077,     0.00218223564743], #TEST
[-0.00121999229413,     0.00731512081389,     0.00022471558091], #TEST
[ 0.00580267354081,    -0.00113547784629,     0.00246418190880], #TEST
[-0.00570596119514,    -0.00464715080422,    -0.00002647227634], #TEST
[-0.00018571984645,     0.00186434821939,    -0.00233170096960], #TEST
] #TEST

molecule water_trimer {
O      -2.76373224  -1.24377706  -0.15444566
H      -1.12357791  -2.06227970  -0.05243799
H      -3.80792362  -2.08705525   1.06090407
--
O       2.46924614  -1.75437739  -0.17092884
H       3.76368260  -2.21425403   1.00846104
H       2.30598330   0.07098445  -0.03942473
--
O       0.29127930   3.00875625   0.20308515
H      -1.21253048   1.95820900   0.10303324
H       0.10002049   4.24958115  -1.10222079
no_reorient
no_com
symmetry c1
units bohr
}

for bsse in ['NoCP', 'CP', 'VMFC']:
    for basis in ['cc-pV[D, T]Z', 'cc-pV[T, Q]Z']:
        g = gradient('MP2/' + basis, molecule=water_trimer, bsse_type=bsse,
                                     max_nbody=2, return_total_data=True)
        core.clean()

        compare_arrays(g, gradients[bsse + '_' + basis], 6, #TEST
                       bsse + '-Corrected MP2/' + basis + ' Gradient') #TEST
