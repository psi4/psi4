#! Convergence of many-body gradients of different BSSE schemes

gradients = {} #TEST

gradients['NoCP_cc-pV[D, T]Z'] = [ #TEST
[-0.00000000459132,     0.00000000000000,    -0.02855987395872], #TEST
[ 0.00000000189053,    -0.01663643023346,     0.01473007240228], #TEST
[ 0.00000000189053,     0.01663643023346,     0.01473007240228], #TEST
[-0.02846295304976,     0.00000000000000,    -0.00045013533044], #TEST
[ 0.02846295386001,    -0.00000000000000,    -0.00045013551542], #TEST
] #TEST

gradients['NoCP_cc-pV[T, Q]Z'] = [
[ 0.00000001496059,     0.00000000000000,    -0.02839590529557], #TEST
[-0.00000000665428,    -0.01670235496832,     0.01464215355646], #TEST
[-0.00000000665428,     0.01670235496832,     0.01464215355646], #TEST
[-0.02842739922511,     0.00000000000000,    -0.00044420070124], #TEST
[ 0.02842739757306,    -0.00000000000000,    -0.00044420111631], #TEST
]

gradients['CP_cc-pV[D, T]Z'] = [ #TEST
[-0.00000001055508,     0.00000000000000,    -0.02880422976614], #TEST
[ 0.00000000457636,    -0.01685788263796,     0.01480599586603], #TEST
[ 0.00000000457636,     0.01685788263796,     0.01480599586603], #TEST
[-0.02852657242757,    -0.00000000000000,    -0.00040388077722], #TEST
[ 0.02852657382993,     0.00000000000000,    -0.00040388118869], #TEST
] #TEST

gradients['CP_cc-pV[T, Q]Z'] = [ #TEST
[-0.00000000642487,     0.00000000000000,    -0.02849872615532], #TEST
[ 0.00000000286778,    -0.01680474817379,     0.01467375969923], #TEST
[ 0.00000000286778,     0.01680474817379,     0.01467375969923], #TEST
[-0.02843310965042,    -0.00000000000000,    -0.00042439677718], #TEST
[ 0.02843311033973,     0.00000000000000,    -0.00042439646619], #TEST
] #TEST

gradients['VMFC_cc-pV[D, T]Z'] = [ #TEST
[-0.00000000128056,     0.00000000000000,    -0.02879366361208], #TEST
[ 0.00000000039324,    -0.01683837918228,     0.01479571524443], #TEST
[ 0.00000000039324,     0.01683837918228,     0.01479571524443], #TEST
[-0.02852790606780,     0.00000000000000,    -0.00039888334506], #TEST
[ 0.02852790656187,    -0.00000000000000,    -0.00039888353189], #TEST
]

gradients['VMFC_cc-pV[T, Q]Z'] = [ #TEST
[-0.00000000517177,     0.00000000000000,    -0.02849038195489], #TEST
[ 0.00000000210539,    -0.01680887735153,     0.01467179106285], #TEST
[ 0.00000000210539,     0.01680887735153,     0.01467179106285], #TEST
[-0.02843364270535,     0.00000000000000,    -0.00042660017358], #TEST
[ 0.02843364366631,    -0.00000000000000,    -0.00042659999721], #TEST
] #TEST

molecule trimer {
O            0.000000000000     0.000000000000    -0.065775570547
H            0.000000000000    -0.759061990794     0.521953018286
H            0.000000000000     0.759061990794     0.521953018286
--
He 2 0 0
--
He -2 0 0
}

for bsse in ['NoCP', 'CP', 'VMFC']:
    for basis in ['cc-pV[D, T]Z', 'cc-pV[T, Q]Z']:
        g = gradient('SCF/' + basis, molecule=trimer, bsse_type=bsse,
                                     max_nbody=2, return_total_data=True)
        core.clean()

        compare_arrays(g, gradients[bsse + '_' + basis], 6, #TEST
                       bsse + '-Corrected SCF/' + basis + ' Gradient') #TEST
