#! Tests RHF/ROHF/UHF SCF gradients

ref_rhf = psi4.Matrix.from_list(            #TEST
[[0.0,  0.00000000e+00, -5.95973789e-02],   #TEST
 [0.0, -4.30395224e-02,  2.97986894e-02],   #TEST
 [0.0,  4.30395224e-02,  2.97986894e-02]])  #TEST
ref_rohf = psi4.Matrix.from_list(           #TEST
[[0.0,  0.00000000e+00,  6.86276760e-02],   #TEST
 [0.0,  4.53106586e-02, -3.43138380e-02],   #TEST
 [0.0, -4.53106586e-02, -3.43138380e-02]])  #TEST
ref_uhf = psi4.Matrix.from_list(            #TEST
[[0.0,  0.00000000e+00,  7.03280322e-02],   #TEST
 [0.0,  4.63402834e-02, -3.51640161e-02],   #TEST
 [0.0, -4.63402834e-02, -3.51640161e-02]])  #TEST

molecule h2o {
0 1
O
H 1 R
H 1 R 2 A

R = 1.0
A = 104.5
}

set {
   reference rhf
   basis cc-pvdz
   e_convergence 8
   d_convergence 8
}

analytic, wfn = gradient('scf', return_wfn=True)

compare_matrices(ref_rhf, analytic, 5, "RHF SCF reference vs. analytic gradient to 10^-5") #TEST

set findif points 3
findif = gradient('scf', dertype=0)

compare_matrices(analytic, findif, 5, "RHF SCF finite-diff (3-pt) vs. analytic gradient to 10^-5") #TEST

set findif points 5
findif = gradient('scf', dertype=0)

compare_matrices(analytic, findif, 7, "RHF SCF finite-diff (5-pt) vs. analytic gradient to 10^-7") #TEST

molecule h2o {
0 3
O
H 1 R
H 1 R 2 A

R = 1.0
A = 104.5
}

set {
   reference rohf
   basis cc-pvdz
}

analytic, wfn = gradient('scf', return_wfn=True)

compare_matrices(ref_rohf, analytic, 5, "ROHF SCF reference vs. analytic gradient to 10^-5") #TEST

set findif points 3
findif = gradient('scf', dertype=0)

compare_matrices(analytic, findif, 5, "ROHF SCF finite-diff (3-pt) vs. analytic gradient to 10^-5") #TEST

set findif points 5
findif = gradient('scf', dertype=0)

compare_matrices(analytic, findif, 7, "ROHF SCF finite-diff (5-pt) vs. analytic gradient to 10^-7") #TEST

molecule h2o {
0 3
O
H 1 R
H 1 R 2 A

R = 1.0
A = 104.5
}

set {
   reference uhf
   basis cc-pvdz
}

analytic, wfn = gradient('scf', return_wfn=True)

compare_matrices(ref_uhf, analytic, 5, "UHF SCF reference vs. analytic gradient to 10^-5") #TEST

set findif points 3
findif = gradient('scf', dertype=0)

compare_matrices(analytic, findif, 5, "UHF SCF finite-diff (3-pt) vs. analytic gradient to 10^-5") #TEST

set findif points 5
findif = gradient('scf', dertype=0)

compare_matrices(analytic, findif, 7, "UHF SCF finite-diff (5-pt) vs. analytic gradient to 10^-7") #TEST

