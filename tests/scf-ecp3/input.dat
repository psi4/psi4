#! Water-Argon complex with ECP present; check of UHF Hessian

molecule arwater {
    1 2
    Ar           0.000000000000     0.000000000000     1.093338152877
    O            0.000000000000     0.000000000000    -2.481615873104
    H            0.000000000000    -0.854670041110    -1.984056761964
    H           -0.000000000000     0.854670041110    -1.984056761964
}

set = {
    basis          lanl2dz
    d_convergence  12
    reference      uhf
}

if psi4.core.get_option("scf", "orbital_optimizer_package") != "INTERNAL":
    psi4.set_options({"e_convergence": 9, "d_convergence": 5e-9})

# Analytic Hessian
hess2 = hessian('scf')
# Hessian from finite differences of energies
hess0 = hessian('scf', dertype=0)
compare_matrices(hess0, hess2, 3, "UHF ECP finite-diff of energies vs. analytic Hessian to 10^-3") #TEST
# Hessian from finite differences of gradients
hess1 = hessian('scf', dertype=1)
compare_matrices(hess1, hess2, 3, "UHF ECP finite-diff of gradients vs. analytic Hessian to 10^-3") #TEST
