#! Test INCFOCK with ROHF (Restricted Open-Shell Hartree-Fock)
#! Validates IncFock for open-shell systems
#! Uses screening=DENSITY, validates energy AND iteration count

print(' INCFOCK with ROHF') #TEST

molecule oxygen {
    0 3
    O
}

# Reference values from incfock=false, screening=density runs
Eref_rohf = -74.787513074624
Iref_rohf = 14

set {
    basis cc-pvdz
    scf_type direct
    screening density
    incfock true
    incfock_convergence 1e-10
    e_convergence 1e-10
    d_convergence 1e-8
    reference rohf
}

# ROHF with INCFOCK
E, wfn = energy('scf', return_wfn=True)
compare_values(Eref_rohf, E, 8, 'ROHF INCFOCK DENSITY: Energy') #TEST
compare_integers(Iref_rohf, wfn.iteration_, 'ROHF INCFOCK DENSITY: Iterations') #TEST
