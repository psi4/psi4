#! OMP2 cc-pVDZ gradient for the NO radical

# Test values are analytic from Jonathon's Psi4Numpy code, run 03/20, residual convergence 12. # TEST
ref = psi4.Matrix.from_list([                                 #TEST
        [ 0.000000000000,  0.000000000000,  0.047448620530],  #TEST
        [ 0.000000000000,  0.000000000000, -0.047448620530]   #TEST
      ])                                                      #TEST

molecule no {
0 2
n
o 1 1.158
}

set {
  basis cc-pvdz
  reference uhf
  guess gwh
  mp2_type conv
}

if psi4.core.get_option("scf", "orbital_optimizer_package") != "INTERNAL":
    psi4.set_options({"e_convergence": 9, "d_convergence": 5e-9})

grad = gradient('omp2')

compare_matrices(ref, grad, 5, "Analytic gradients")              #TEST

