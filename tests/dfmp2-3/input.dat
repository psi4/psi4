#! DF-MP2 cc-pVDZ frozen core gradient of benzene, computed at the DF-SCF cc-pVDZ geometry

ref_vals = [                                                 #TEST
             [ 0.0040014655,  0.0000000000,  0.0069307508],  #TEST
             [-0.0040014655,  0.0000000000,  0.0069307508],  #TEST
             [-0.0080028871,  0.0000000000,  0.0000000000],  #TEST
             [-0.0040014655,  0.0000000000, -0.0069307508],  #TEST
             [ 0.0040014655,  0.0000000000, -0.0069307508],  #TEST
             [ 0.0080028871,  0.0000000000,  0.0000000000],  #TEST
             [ 0.0047224616,  0.0000000000,  0.0081795432],  #TEST
             [-0.0047224616,  0.0000000000,  0.0081795432],  #TEST
             [-0.0094449331,  0.0000000000,  0.0000000000],  #TEST
             [-0.0047224616,  0.0000000000, -0.0081795432],  #TEST
             [ 0.0047224616,  0.0000000000, -0.0081795432],  #TEST
             [ 0.0094449331,  0.0000000000,  0.0000000000]   #TEST
           ]                                                 #TEST
ref = PsiMod.Matrix(12, 3)                                   #TEST
ref.set(ref_vals)                                            #TEST
memory 250 mb
molecule {
    C         -0.694303272975    -0.000000000000    -1.202568545351
    C          0.694303272975     0.000000000000    -1.202568545351
    C          1.388606546154     0.000000000000     0.000000000000
    C          0.694303272975     0.000000000000     1.202568545351
    C         -0.694303272975    -0.000000000000     1.202568545351
    C         -1.388606546154    -0.000000000000     0.000000000000
    H         -1.235418032354    -0.000000000000    -2.139806800843
    H          1.235418032354     0.000000000000    -2.139806800843
    H          2.470836065313     0.000000000000     0.000000000000
    H          1.235418032354     0.000000000000     2.139806800843
    H         -1.235418032354    -0.000000000000     2.139806800843
    H         -2.470836065313    -0.000000000000     0.000000000000
}

set {
    scf_type      df
    basis         cc-pvdz
    freeze_core   true
}

gradient("df-mp2")

grad = PsiMod.reference_wavefunction().gradient()                                  #TEST
compare_matrices(ref, grad, 7, "Analytic gradients, vs. 5 point numerical values") #TEST
