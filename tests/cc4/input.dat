#! RHF-CCSD(T) cc-pVQZ frozen-core energy of the BH molecule, with Cartesian input.
#! After the computation, the checkpoint file is renamed, using the PSIO handler.

memory 250 mb

refnuc   =   2.645886245000000 #TEST
refscf   = -25.103546873615137 #TEST
refccsd  =  -0.100265803802460 #TEST
ref_t    =  -0.002090933428780 #TEST
reftotal = -25.205903610846349 #TEST

molecule bh {
    b      0.0000        0.0000        0.0000
    h      0.0000        0.0000        1.0000
}

set {
   docc [3, 0, 0, 0]
   basis cc-pvqz
   freeze_core true
   r_convergence 10
   e_convergence 10
   d_convergence 10
}

energy('ccsd(t)')

compare_values(refnuc,   bh.nuclear_repulsion_energy(),           9, "Nuclear repulsion energy") #TEST
compare_values(refscf,   get_variable("SCF total energy"),        9, "SCF energy")               #TEST
compare_values(refccsd,  get_variable("CCSD correlation energy"), 9, "CCSD contribution")        #TEST
compare_values(ref_t,    get_variable("(T) correction energy"),   9, "(T) contribution")         #TEST
compare_values(reftotal, get_variable("Current energy"),          9, "Total energy")             #TEST

#Here's a demonstration of how to print an manipulate the files used by Psi
psi4_io.print_out()
PsiMod.IO.change_file_namespace(32, 'bh', 'cool')
psi4_io.print_out()
