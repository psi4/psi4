#! PE-SCF of PNA in presence of 6 water molecules
#! Reference data from Dalton
#          Polarizability tensor for frequency     0.000000 au
#          ----------------------------------------------------
#                            Ex             Ey             Ez
#
#                Ex    36.14995      -26.70382       3.599036
#                Ey   -26.70384       35.10354       8.957926
#                Ez    3.598892       8.958217       78.45963

alpha_diag = [36.14995,  35.10354, 78.45963] 

ref_pe_energy = -0.03424830892844 #TEST
ref_scf_energy = -482.9411084900 #TEST

molecule pna {
C          8.64800        1.07500       -1.71100
C          9.48200        0.43000       -0.80800
C          9.39600        0.75000        0.53800
C          8.48200        1.71200        0.99500
C          7.65300        2.34500        0.05500
C          7.73200        2.03100       -1.29200
H         10.18300       -0.30900       -1.16400
H         10.04400        0.25200        1.24700
H          6.94200        3.08900        0.38900
H          7.09700        2.51500       -2.01800
N          8.40100        2.02500        2.32500
N          8.73400        0.74100       -3.12900
O          7.98000        1.33100       -3.90100
O          9.55600       -0.11000       -3.46600
H          7.74900        2.71100        2.65200
H          8.99100        1.57500        2.99500
symmetry c1
no_reorient
no_com
}

set {
 basis sto-3g
 pe true
 e_convergence 10
 d_convergence 10
 scf_type pk
}

set pe {
 potfile pna_6w.pot
}

scf_energy, wfn = properties("SCF", properties=["DIPOLE_POLARIZABILITIES"], return_wfn=True)
print_variables()
compare_values(ref_pe_energy, wfn.get_variable("PE ENERGY"), 6, "PE Energy contribution") #TEST
compare_values(ref_scf_energy, scf_energy, 6, "Total PE-SCF Energy") #TEST
compare_values(alpha_diag[0],variable('DIPOLE POLARIZABILITY XX'),4,'PCM DIPOLE POLARIZABILITY XX') #TEST
compare_values(alpha_diag[1],variable('DIPOLE POLARIZABILITY YY'),4,'PCM DIPOLE POLARIZABILITY YY') #TEST
compare_values(alpha_diag[2],variable('DIPOLE POLARIZABILITY ZZ'),4,'PCM DIPOLE POLARIZABILITY ZZ') #TEST

