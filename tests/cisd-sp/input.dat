#! 6-31G** H2O Test CISD Energy Point

memory 250 mb

refnuc   =   8.8046872910  #TEST
refscf   = -76.0172965718  #TEST
refci    = -76.21984746    #TEST
refcorr  = refci - refscf  #TEST

molecule h2o {
    O
    H 1 1.00
    H 1 1.00 2 103.1
}

# Perform a detci calc using helper function
set globals {
  basis 6-31G**
  hd_avg hd_kave
}

thisenergy = energy('cisd')

compare_values(refnuc, h2o.nuclear_repulsion_energy(), 9, "[1] Nuclear repulsion energy") #TEST 
compare_values(refscf, get_variable("SCF total energy"), 9, "[1] SCF energy") #TEST
compare_values(refci, thisenergy, 7, "[1] CISD energy") #TEST
compare_values(refcorr, get_variable("CI CORRELATION ENERGY"), 7, "[1] CISD correlation energy") #TEST

clean()

# Perform same detci calc setting all options explicitly
set globals {
  wfn detci
  basis 6-31G**
}

set detci {
  hd_avg hd_kave
  ex_level 2
}

thisenergy = energy('detci')

compare_values(refnuc, h2o.nuclear_repulsion_energy(), 9, "[2] Nuclear repulsion energy") #TEST 
compare_values(refscf, get_variable("SCF total energy"), 9, "[2] SCF energy") #TEST
compare_values(refci, thisenergy, 7, "[2] CISD energy") #TEST
compare_values(refcorr, get_variable("CI CORRELATION ENERGY"), 7, "[2] CISD correlation energy") #TEST
