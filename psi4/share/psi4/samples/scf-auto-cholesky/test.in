#! Cholesky filter a complete basis

# Reference HF energy
reference_energy = -40.2170789282755266

molecule {
0 1
C    0.000000000000   0.000000000000   0.000000000000
H    0.627600000000   0.627600000000   0.627600000000
H    0.627600000000  -0.627600000000  -0.627600000000
H   -0.627600000000   0.627600000000  -0.627600000000
H   -0.627600000000  -0.627600000000   0.627600000000
}

basis {
assign complete

[complete]
spherical
****
H 0
S 1 1.0
  7.7717777442e+04 1.0
S 1 1.0
  4.0227250055e+04 1.0
S 1 1.0
  2.0821898159e+04 1.0
S 1 1.0
  1.0777556068e+04 1.0
S 1 1.0
  5.5785363042e+03 1.0
S 1 1.0
  2.8874883230e+03 1.0
S 1 1.0
  1.4945835898e+03 1.0
S 1 1.0
  7.7360662870e+02 1.0
S 1 1.0
  4.0042405125e+02 1.0
S 1 1.0
  2.0726221166e+02 1.0
S 1 1.0
  1.0728033006e+02 1.0
S 1 1.0
  5.5529028305e+01 1.0
S 1 1.0
  2.8742202627e+01 1.0
S 1 1.0
  1.4877159516e+01 1.0
S 1 1.0
  7.7005189246e+00 1.0
S 1 1.0
  3.9858409560e+00 1.0
S 1 1.0
  2.0630983811e+00 1.0
S 1 1.0
  1.0678737503e+00 1.0
S 1 1.0
  5.5273871431e-01 1.0
S 1 1.0
  2.8610131694e-01 1.0
S 1 1.0
  1.4808798703e-01 1.0
S 1 1.0
  7.6651349030e-02 1.0
S 1 1.0
  3.9675259458e-02 1.0
S 1 1.0
  2.0536184072e-02 1.0
S 1 1.0
  1.0629668514e-02 1.0
P 1 1.0
  4.9729544510e+01 1.0
P 1 1.0
  2.6899149919e+01 1.0
P 1 1.0
  1.4549987809e+01 1.0
P 1 1.0
  7.8702169357e+00 1.0
P 1 1.0
  4.2570698634e+00 1.0
P 1 1.0
  2.3026866946e+00 1.0
P 1 1.0
  1.2455435743e+00 1.0
P 1 1.0
  6.7372552203e-01 1.0
P 1 1.0
  3.6442408633e-01 1.0
P 1 1.0
  1.9712020749e-01 1.0
P 1 1.0
  1.0662406153e-01 1.0
P 1 1.0
  5.7673896760e-02 1.0
P 1 1.0
  3.1196320229e-02 1.0
P 1 1.0
  1.6874365190e-02 1.0
P 1 1.0
  9.1274931936e-03 1.0
P 1 1.0
  4.9371416976e-03 1.0
P 1 1.0
  2.6705435573e-03 1.0
P 1 1.0
  1.4445206008e-03 1.0
D 1 1.0
  1.9872405072e+00 1.0
D 1 1.0
  1.1203405838e+00 1.0
D 1 1.0
  6.3161103001e-01 1.0
D 1 1.0
  3.5608144434e-01 1.0
D 1 1.0
  2.0074696131e-01 1.0
D 1 1.0
  1.1317450858e-01 1.0
D 1 1.0
  6.3804051168e-02 1.0
D 1 1.0
  3.5970617383e-02 1.0
D 1 1.0
  2.0279046412e-02 1.0
D 1 1.0
  1.1432656798e-02 1.0
D 1 1.0
  6.4453544224e-03 1.0
D 1 1.0
  3.6336780123e-03 1.0
D 1 1.0
  2.0485476875e-03 1.0
D 1 1.0
  1.1549035478e-03 1.0
D 1 1.0
  6.5109648792e-04 1.0
F 1 1.0
  3.3471211201e-01 1.0
F 1 1.0
  1.9811182333e-01 1.0
F 1 1.0
  1.1725985746e-01 1.0
F 1 1.0
  6.9404611699e-02 1.0
F 1 1.0
  4.1079703058e-02 1.0
F 1 1.0
  2.4314551469e-02 1.0
F 1 1.0
  1.4391472410e-02 1.0
F 1 1.0
  8.5181286760e-03 1.0
F 1 1.0
  5.0417715488e-03 1.0
F 1 1.0
  2.9841601739e-03 1.0
F 1 1.0
  1.7662862859e-03 1.0
F 1 1.0
  1.0454422893e-03 1.0
F 1 1.0
  6.1878393606e-04 1.0
F 1 1.0
  3.6625030713e-04 1.0
****
C 0
S 1 1.0
  2.6417532443e+06 1.0
S 1 1.0
  1.3716828821e+06 1.0
S 1 1.0
  7.1222167816e+05 1.0
S 1 1.0
  3.6980830297e+05 1.0
S 1 1.0
  1.9201631338e+05 1.0
S 1 1.0
  9.9701018898e+04 1.0
S 1 1.0
  5.1767961766e+04 1.0
S 1 1.0
  2.6879583529e+04 1.0
S 1 1.0
  1.3956740541e+04 1.0
S 1 1.0
  7.2467866293e+03 1.0
S 1 1.0
  3.7627636838e+03 1.0
S 1 1.0
  1.9537474007e+03 1.0
S 1 1.0
  1.0144482158e+03 1.0
S 1 1.0
  5.2673399961e+02 1.0
S 1 1.0
  2.7349716035e+02 1.0
S 1 1.0
  1.4200848393e+02 1.0
S 1 1.0
  7.3735352434e+01 1.0
S 1 1.0
  3.8285756232e+01 1.0
S 1 1.0
  1.9879190671e+01 1.0
S 1 1.0
  1.0321912393e+01 1.0
S 1 1.0
  5.3594674561e+00 1.0
S 1 1.0
  2.7828071309e+00 1.0
S 1 1.0
  1.4449225770e+00 1.0
S 1 1.0
  7.5025007313e-01 1.0
S 1 1.0
  3.8955386344e-01 1.0
S 1 1.0
  2.0226884069e-01 1.0
S 1 1.0
  1.0502445940e-01 1.0
S 1 1.0
  5.4532062547e-02 1.0
S 1 1.0
  2.8314793170e-02 1.0
S 1 1.0
  1.4701947346e-02 1.0
S 1 1.0
  7.6337218668e-03 1.0
P 1 1.0
  1.7917107054e+03 1.0
P 1 1.0
  9.6908403369e+02 1.0
P 1 1.0
  5.2414927339e+02 1.0
P 1 1.0
  2.8349704592e+02 1.0
P 1 1.0
  1.5333527894e+02 1.0
P 1 1.0
  8.2934577652e+01 1.0
P 1 1.0
  4.4856892802e+01 1.0
P 1 1.0
  2.4261784274e+01 1.0
P 1 1.0
  1.3122491091e+01 1.0
P 1 1.0
  7.0975724820e+00 1.0
P 1 1.0
  3.8388698296e+00 1.0
P 1 1.0
  2.0763326625e+00 1.0
P 1 1.0
  1.1230277443e+00 1.0
P 1 1.0
  6.0741293395e-01 1.0
P 1 1.0
  3.2853193006e-01 1.0
P 1 1.0
  1.7769333354e-01 1.0
P 1 1.0
  9.6109138551e-02 1.0
P 1 1.0
  5.1982628324e-02 1.0
P 1 1.0
  2.8115886670e-02 1.0
P 1 1.0
  1.5207062604e-02 1.0
P 1 1.0
  8.2250563802e-03 1.0
P 1 1.0
  4.4486929672e-03 1.0
P 1 1.0
  2.4061682013e-03 1.0
D 1 1.0
  7.1539173779e+01 1.0
D 1 1.0
  4.0331561774e+01 1.0
D 1 1.0
  2.2737680479e+01 1.0
D 1 1.0
  1.2818797260e+01 1.0
D 1 1.0
  7.2268393141e+00 1.0
D 1 1.0
  4.0742672976e+00 1.0
D 1 1.0
  2.2969452192e+00 1.0
D 1 1.0
  1.2949462945e+00 1.0
D 1 1.0
  7.3005045646e-01 1.0
D 1 1.0
  4.1157974753e-01 1.0
D 1 1.0
  2.3203586421e-01 1.0
D 1 1.0
  1.3081460543e-01 1.0
D 1 1.0
  7.3749207061e-02 1.0
D 1 1.0
  4.1577509820e-02 1.0
D 1 1.0
  2.3440107247e-02 1.0
D 1 1.0
  1.3214803631e-02 1.0
D 1 1.0
  7.4500953927e-03 1.0
D 1 1.0
  4.2001321329e-03 1.0
D 1 1.0
  2.3679038998e-03 1.0
D 1 1.0
  1.3349505923e-03 1.0
D 1 1.0
  7.5260363565e-04 1.0
F 1 1.0
  1.2050618108e+01 1.0
F 1 1.0
  7.1325092428e+00 1.0
F 1 1.0
  4.2215832950e+00 1.0
F 1 1.0
  2.4986670062e+00 1.0
F 1 1.0
  1.4789088291e+00 1.0
F 1 1.0
  8.7533525654e-01 1.0
F 1 1.0
  5.1809266146e-01 1.0
F 1 1.0
  3.0664822861e-01 1.0
F 1 1.0
  1.8149868374e-01 1.0
F 1 1.0
  1.0742528124e-01 1.0
F 1 1.0
  6.3582780940e-02 1.0
F 1 1.0
  3.7633320438e-02 1.0
F 1 1.0
  2.2274376589e-02 1.0
F 1 1.0
  1.3183738417e-02 1.0
F 1 1.0
  7.8031794942e-03 1.0
F 1 1.0
  4.6185390133e-03 1.0
F 1 1.0
  2.7336168075e-03 1.0
F 1 1.0
  1.6179707108e-03 1.0
F 1 1.0
  9.5764308071e-04 1.0
F 1 1.0
  5.6680894401e-04 1.0
F 1 1.0
  3.3548237907e-04 1.0
G 1 1.0
  3.2140956223e+00 1.0
G 1 1.0
  1.9568491258e+00 1.0
G 1 1.0
  1.1913953258e+00 1.0
G 1 1.0
  7.2536140043e-01 1.0
G 1 1.0
  4.4162432893e-01 1.0
G 1 1.0
  2.6887569118e-01 1.0
G 1 1.0
  1.6370053137e-01 1.0
G 1 1.0
  9.9666369436e-02 1.0
G 1 1.0
  6.0680225736e-02 1.0
G 1 1.0
  3.6944154947e-02 1.0
G 1 1.0
  2.2492839606e-02 1.0
G 1 1.0
  1.3694394533e-02 1.0
G 1 1.0
  8.3376063189e-03 1.0
G 1 1.0
  5.0762141372e-03 1.0
G 1 1.0
  3.0905692810e-03 1.0
G 1 1.0
  1.8816421496e-03 1.0
G 1 1.0
  1.1456067983e-03 1.0
G 1 1.0
  6.9748381046e-04 1.0
G 1 1.0
  4.2465151791e-04 1.0
G 1 1.0
  2.5854207505e-04 1.0
****
}

e_test = energy('hf')
compare_values(e_test, reference_energy, 8, "HF energy with auto Cholesky")                                        #TEST
