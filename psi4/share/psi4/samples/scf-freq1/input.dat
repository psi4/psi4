#! Analytic vs. finite difference DF-SCF frequency test for water.

molecule h2o {
    0 1
    O
    H 1 r 
    H 1 r 2 a

    r = 0.951356
    a = 112.516353
}
set {
    e_convergence 1e-12
    d_convergence 1e-12
    r_convergence 1e-12
    basis dz
}

# cc-pv5z-jkfit with the d orbitals and above removed, to allow testing with minimal libint.
df_basis_scf  {
   assign myribasis
    [ myribasis ] 
    spherical
****
H     0
S   1   1.00
      9.5302493300           1.0000000000
S   1   1.00
      1.9174506200           1.0000000000
S   1   1.00
      0.6842404900           1.0000000000
S   1   1.00
      0.2841325600           1.0000000000
P   1   1.00
      2.9133232000           1.0000000000
P   1   1.00
      1.2621205400           1.0000000000
P   1   1.00
      0.5019977600           1.0000000000
D   1   1.00
      4.2855836400           1.0000000000
D   1   1.00
      2.1689089200           1.0000000000
D   1   1.00
      1.0087901000           1.0000000000
D   1   1.00
      0.3189862800           1.0000000000
****
O     0
S   1   1.00
   1517.8667506000           1.0000000000
S   1   1.00
    489.6795200800           1.0000000000
S   1   1.00
    176.7211866500           1.0000000000
S   1   1.00
     63.7922331400           1.0000000000
S   1   1.00
     25.3664991300           1.0000000000
S   1   1.00
      9.9135491200           1.0000000000
S   1   1.00
      4.4645306600           1.0000000000
S   1   1.00
      1.8017743700           1.0000000000
S   1   1.00
      0.8078971100           1.0000000000
S   1   1.00
      0.3386432700           1.0000000000
P   1   1.00
    120.1603092100           1.0000000000
P   1   1.00
     34.4096224700           1.0000000000
P   1   1.00
     12.5811486100           1.0000000000
P   1   1.00
      5.0663824200           1.0000000000
P   1   1.00
      2.0346927100           1.0000000000
P   1   1.00
      0.8609296700           1.0000000000
P   1   1.00
      0.3668135700           1.0000000000
D   1   1.00
     19.0430628100           1.0000000000
D   1   1.00
      5.8060381100           1.0000000000
D   1   1.00
      2.1891841600           1.0000000000
D   1   1.00
      0.8779461400           1.0000000000
D   1   1.00
      0.3562364700           1.0000000000
****
}


Efd, fdwfn = freq('scf', dertype=1, return_wfn=True)
Ean, anwfn = freq('scf', return_wfn=True)
fdwfn.frequencies().print_out()
anwfn.frequencies().print_out()

