#! Computation of VMFC-corrected water trimer gradient (geometry from J. Chem. Theory Comput. 11, 2126-2136 (2015))

import numpy as np

molecule water_trimer {
O      -2.76373224  -1.24377706  -0.15444566
H      -1.12357791  -2.06227970  -0.05243799
H      -3.80792362  -2.08705525   1.06090407
--
O       2.46924614  -1.75437739  -0.17092884
H       3.76368260  -2.21425403   1.00846104
H       2.30598330   0.07098445  -0.03942473
--
O       0.29127930   3.00875625   0.20308515
H      -1.21253048   1.95820900   0.10303324
H       0.10002049   4.24958115  -1.10222079
no_reorient
no_com
symmetry c1
units bohr
}

g, wfn = psi4.gradient('SCF/STO-3G', molecule=water_trimer, bsse_type='vmfc',
                                      return_total_data=True, return_wfn=True)
core.clean()








 

grad_maxnb2 = np.array(
     [[ 0.002155804191, -0.029634185797,  0.032376607396],
      [-0.003170680084,  0.014254859601, -0.006078802815],
      [ 0.012483476168,  0.023203573171, -0.025365946635],
      [ 0.025226012667,  0.016325441914,  0.031594301626],
      [-0.027006236709, -0.001406222833, -0.024814674937],
      [-0.010724421068, -0.008596936788, -0.007375340751],
      [-0.024435013809,  0.009777336603, -0.035394108341],
      [ 0.012544129973, -0.004104715215,  0.008163796645],
      [ 0.012926928671, -0.019819150657,  0.026894167812]])
grad_maxnb3 = np.array(
     [[ 0.002219694063,  0.009321053605, -0.006605392323],
      [ 0.004716622541, -0.000932172428,  0.004496896826],
      [ 0.001311905336, -0.002455421929,  0.003035312701],
      [-0.009018191555, -0.002317388378, -0.00680297185 ],
      [ 0.001420670764,  0.002045748088,  0.003021479389],
      [-0.001682106814,  0.004664038597,  0.003106497953],
      [ 0.006639093791, -0.006637441486,  0.005420065144],
      [-0.003115962895, -0.004227261417, -0.002455116289],
      [-0.002491725232,  0.000538845348, -0.003216771551]])
